{
	"@programName": "ZAP",
	"@version": "2.16.1",
	"@generated": "Fri, 31 Oct 2025 20:57:17",
	"created": "2025-10-31T20:57:17.143780232Z",
	"site":[ 
		{
			"@name": "http://dacn:4000",
			"@host": "dacn",
			"@port": "4000",
			"@ssl": "false",
			"alerts": [ 
				{
					"pluginid": "10055",
					"alertRef": "10055-13",
					"alert": "CSP: Failure to Define Directive with No Fallback",
					"name": "CSP: Failure to Define Directive with No Fallback",
					"riskcode": "2",
					"confidence": "3",
					"riskdesc": "Medium (High)",
					"desc": "<p>The Content Security Policy fails to define one of the directives that has no fallback. Missing/excluding them is the same as allowing anything.</p>",
					"instances":[ 
						{
							"id": "133",
							"uri": "http://dacn:4000/allocations/",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "145",
							"uri": "http://dacn:4000/form",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "143",
							"uri": "http://dacn:4000/h1",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "146",
							"uri": "http://dacn:4000/h2",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "144",
							"uri": "http://dacn:4000/head",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "137",
							"uri": "http://dacn:4000/html",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "20",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "139",
							"uri": "http://dacn:4000/script",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "135",
							"uri": "http://dacn:4000/server.js",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "138",
							"uri": "http://dacn:4000/site/search?value",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "24",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						},
						{
							"id": "140",
							"uri": "http://dacn:4000/span",
							"method": "GET",
							"param": "Content-Security-Policy",
							"attack": "",
							"evidence": "default-src 'self'",
							"otherinfo": "The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src."
						}
					],
					"count": "12",
					"solution": "<p>Ensure that your web server, application server, load balancer, etc. is properly configured to set the Content-Security-Policy header.</p>",
					"otherinfo": "<p>The directive(s): frame-ancestors, form-action is/are among the directives that do not fallback to default-src.</p>",
					"reference": "<p>https://www.w3.org/TR/CSP/</p><p>https://caniuse.com/#search=content+security+policy</p><p>https://content-security-policy.com/</p><p>https://github.com/HtmlUnit/htmlunit-csp</p><p>https://web.dev/articles/csp#resource-options</p>",
					"cweid": "693",
					"wascid": "15",
					"sourceid": "76"
				},
				{
					"pluginid": "10038",
					"alertRef": "10038-1",
					"alert": "Content Security Policy (CSP) Header Not Set",
					"name": "Content Security Policy (CSP) Header Not Set",
					"riskcode": "2",
					"confidence": "3",
					"riskdesc": "Medium (High)",
					"desc": "<p>Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware. CSP provides a set of standard HTTP headers that allow website owners to declare approved sources of content that browsers should be allowed to load on that page \u2014 covered types are JavaScript, CSS, HTML frames, fonts, images and embeddable objects such as Java applets, ActiveX, audio and video files.</p>",
					"instances":[ 
						{
							"id": "4",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "37",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "64",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "83",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "108",
							"uri": "http://dacn:4000/tutorial/a2",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "93",
							"uri": "http://dacn:4000/tutorial/a3",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "98",
							"uri": "http://dacn:4000/tutorial/a4",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "81",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "118",
							"uri": "http://dacn:4000/tutorial/a6",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "115",
							"uri": "http://dacn:4000/tutorial/a8",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "103",
							"uri": "http://dacn:4000/tutorial/a9",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						}
					],
					"count": "11",
					"solution": "<p>Ensure that your web server, application server, load balancer, etc. is configured to set the Content-Security-Policy header.</p>",
					"otherinfo": "",
					"reference": "<p>https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP</p><p>https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html</p><p>https://www.w3.org/TR/CSP/</p><p>https://w3c.github.io/webappsec-csp/</p><p>https://web.dev/articles/csp</p><p>https://caniuse.com/#feat=contentsecuritypolicy</p><p>https://content-security-policy.com/</p>",
					"cweid": "693",
					"wascid": "15",
					"sourceid": "3"
				},
				{
					"pluginid": "10020",
					"alertRef": "10020-1",
					"alert": "Missing Anti-clickjacking Header",
					"name": "Missing Anti-clickjacking Header",
					"riskcode": "2",
					"confidence": "2",
					"riskdesc": "Medium (Medium)",
					"desc": "<p>The response does not protect against 'ClickJacking' attacks. It should include either Content-Security-Policy with 'frame-ancestors' directive or X-Frame-Options.</p>",
					"instances":[ 
						{
							"id": "2",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "31",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "47",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "63",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "101",
							"uri": "http://dacn:4000/tutorial/a2",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "82",
							"uri": "http://dacn:4000/tutorial/a3",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "89",
							"uri": "http://dacn:4000/tutorial/a4",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "74",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "116",
							"uri": "http://dacn:4000/tutorial/a6",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "114",
							"uri": "http://dacn:4000/tutorial/a8",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "88",
							"uri": "http://dacn:4000/tutorial/a9",
							"method": "GET",
							"param": "x-frame-options",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						}
					],
					"count": "11",
					"solution": "<p>Modern Web browsers support the Content-Security-Policy and X-Frame-Options HTTP headers. Ensure one of them is set on all web pages returned by your site/app.</p><p>If you expect the page to be framed only by pages on your server (e.g. it's part of a FRAMESET) then you'll want to use SAMEORIGIN, otherwise if you never expect the page to be framed, you should use DENY. Alternatively consider implementing Content Security Policy's \"frame-ancestors\" directive.</p>",
					"otherinfo": "",
					"reference": "<p>https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/X-Frame-Options</p>",
					"cweid": "1021",
					"wascid": "15",
					"sourceid": "3"
				},
				{
					"pluginid": "10099",
					"alertRef": "10099",
					"alert": "Source Code Disclosure - SQL",
					"name": "Source Code Disclosure - SQL",
					"riskcode": "2",
					"confidence": "2",
					"riskdesc": "Medium (Medium)",
					"desc": "<p>Application Source Code was disclosed by the web server. - SQL</p>",
					"instances":[ 
						{
							"id": "99",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "SELECT * FROM accounts WHERE username ",
							"otherinfo": ""
						},
						{
							"id": "132",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "SELECT * FROM accounts WHERE username ",
							"otherinfo": ""
						}
					],
					"count": "2",
					"solution": "<p>Ensure that application Source Code is not available with alternative extensions, and ensure that source code is not present within other files or data deployed to the web server, or served by the web server.</p>",
					"otherinfo": "",
					"reference": "<p>https://nhimg.org/twitter-breach</p>",
					"cweid": "540",
					"wascid": "13",
					"sourceid": "22"
				},
				{
					"pluginid": "10003",
					"alertRef": "10003",
					"alert": "Vulnerable JS Library",
					"name": "Vulnerable JS Library",
					"riskcode": "2",
					"confidence": "2",
					"riskdesc": "Medium (Medium)",
					"desc": "<p>The identified library appears to be vulnerable.</p>",
					"instances":[ 
						{
							"id": "73",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "* Bootstrap v3.0.0",
							"otherinfo": "The identified library bootstrap, version 3.0.0 is vulnerable.\nCVE-2018-14041\nCVE-2019-8331\nCVE-2018-20677\nCVE-2018-20676\nCVE-2018-14042\nCVE-2016-10735\nCVE-2024-6484\nCVE-2024-6485\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-6485\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-6484\nhttps://github.com/advisories/GHSA-pj7m-g53m-7638\nhttps://github.com/advisories/GHSA-vxmc-5x29-h64v\nhttps://github.com/rubysec/ruby-advisory-db/blob/master/gems/bootstrap-sass/CVE-2024-6484.yml\nhttps://github.com/twbs/bootstrap/issues/20631\nhttps://github.com/advisories/GHSA-9mvj-f7w8-pvh2\nhttps://github.com/advisories/GHSA-9v3m-8fp8-mj99\nhttps://github.com/twbs/bootstrap/issues/28236\nhttps://www.herodevs.com/vulnerability-directory/cve-2024-6485\nhttps://github.com/twbs/bootstrap/issues/20184\nhttps://www.herodevs.com/vulnerability-directory/cve-2024-6484\nhttps://github.com/advisories/GHSA-ph58-4vrj-w6hr\nhttps://github.com/twbs/bootstrap\nhttps://github.com/advisories/GHSA-4p24-vmcr-4gqj\nhttps://github.com/rubysec/ruby-advisory-db/blob/master/gems/bootstrap/CVE-2024-6484.yml\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-20676\n"
						},
						{
							"id": "69",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "/*! jQuery v1.10.2",
							"otherinfo": "The identified library jquery, version 1.10.2 is vulnerable.\nCVE-2020-11023\nCVE-2020-11022\nCVE-2015-9251\nCVE-2019-11358\nhttps://github.com/jquery/jquery/issues/2432\nhttp://blog.jquery.com/2016/01/08/jquery-2-2-and-1-12-released/\nhttp://research.insecurelabs.org/jquery/test/\nhttps://blog.jquery.com/2019/04/10/jquery-3-4-0-released/\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-11358\nhttps://github.com/advisories/GHSA-rmxg-73gg-4p98\nhttps://nvd.nist.gov/vuln/detail/CVE-2015-9251\nhttps://github.com/jquery/jquery/commit/753d591aea698e57d6db58c9f722cd0808619b1b\nhttps://bugs.jquery.com/ticket/11974\nhttps://github.com/jquery/jquery.com/issues/162\nhttps://blog.jquery.com/2020/04/10/jquery-3-5-0-released/\n"
						}
					],
					"count": "2",
					"solution": "<p>Upgrade to the latest version of the affected library.</p>",
					"otherinfo": "<p>The identified library bootstrap, version 3.0.0 is vulnerable.</p><p>CVE-2018-14041</p><p>CVE-2019-8331</p><p>CVE-2018-20677</p><p>CVE-2018-20676</p><p>CVE-2018-14042</p><p>CVE-2016-10735</p><p>CVE-2024-6484</p><p>CVE-2024-6485</p><p>https://nvd.nist.gov/vuln/detail/CVE-2024-6485</p><p>https://nvd.nist.gov/vuln/detail/CVE-2024-6484</p><p>https://github.com/advisories/GHSA-pj7m-g53m-7638</p><p>https://github.com/advisories/GHSA-vxmc-5x29-h64v</p><p>https://github.com/rubysec/ruby-advisory-db/blob/master/gems/bootstrap-sass/CVE-2024-6484.yml</p><p>https://github.com/twbs/bootstrap/issues/20631</p><p>https://github.com/advisories/GHSA-9mvj-f7w8-pvh2</p><p>https://github.com/advisories/GHSA-9v3m-8fp8-mj99</p><p>https://github.com/twbs/bootstrap/issues/28236</p><p>https://www.herodevs.com/vulnerability-directory/cve-2024-6485</p><p>https://github.com/twbs/bootstrap/issues/20184</p><p>https://www.herodevs.com/vulnerability-directory/cve-2024-6484</p><p>https://github.com/advisories/GHSA-ph58-4vrj-w6hr</p><p>https://github.com/twbs/bootstrap</p><p>https://github.com/advisories/GHSA-4p24-vmcr-4gqj</p><p>https://github.com/rubysec/ruby-advisory-db/blob/master/gems/bootstrap/CVE-2024-6484.yml</p><p>https://nvd.nist.gov/vuln/detail/CVE-2018-20676</p><p></p>",
					"reference": "<p>https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/</p>",
					"cweid": "1395",
					"wascid": "-1",
					"sourceid": "32"
				},
				{
					"pluginid": "10054",
					"alertRef": "10054-1",
					"alert": "Cookie without SameSite Attribute",
					"name": "Cookie without SameSite Attribute",
					"riskcode": "1",
					"confidence": "2",
					"riskdesc": "Low (Medium)",
					"desc": "<p>A cookie has been set without the SameSite attribute, which means that the cookie can be sent as a result of a 'cross-site' request. The SameSite attribute is an effective counter measure to cross-site request forgery, cross-site script inclusion, and timing attacks.</p>",
					"instances":[ 
						{
							"id": "19",
							"uri": "http://dacn:4000",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						},
						{
							"id": "3",
							"uri": "http://dacn:4000/",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						},
						{
							"id": "32",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						},
						{
							"id": "26",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						},
						{
							"id": "27",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						},
						{
							"id": "142",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap-tour.css",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "set-cookie: connect.sid",
							"otherinfo": ""
						}
					],
					"count": "6",
					"solution": "<p>Ensure that the SameSite attribute is set to either 'lax' or ideally 'strict' for all cookies.</p>",
					"otherinfo": "",
					"reference": "<p>https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-cookie-same-site</p>",
					"cweid": "1275",
					"wascid": "13",
					"sourceid": "10"
				},
				{
					"pluginid": "10110",
					"alertRef": "10110",
					"alert": "Dangerous JS Functions",
					"name": "Dangerous JS Functions",
					"riskcode": "1",
					"confidence": "1",
					"riskdesc": "Low (Low)",
					"desc": "<p>A dangerous JS function seems to be in use that would leave the site vulnerable.</p>",
					"instances":[ 
						{
							"id": "92",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "eval(",
							"otherinfo": ""
						},
						{
							"id": "131",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "eval(",
							"otherinfo": ""
						}
					],
					"count": "2",
					"solution": "<p>See the references for security advice on the use of these functions.</p>",
					"otherinfo": "",
					"reference": "<p>https://v17.angular.io/guide/security</p>",
					"cweid": "749",
					"wascid": "-1",
					"sourceid": "22"
				},
				{
					"pluginid": "90004",
					"alertRef": "90004-1",
					"alert": "Insufficient Site Isolation Against Spectre Vulnerability",
					"name": "Insufficient Site Isolation Against Spectre Vulnerability",
					"riskcode": "1",
					"confidence": "2",
					"riskdesc": "Low (Medium)",
					"desc": "<p>Cross-Origin-Resource-Policy header is an opt-in header designed to counter side-channels attacks like Spectre. Resource should be specifically set as shareable amongst different origins.</p>",
					"instances":[ 
						{
							"id": "12",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "Cross-Origin-Resource-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "55",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "Cross-Origin-Resource-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "79",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "Cross-Origin-Resource-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "62",
							"uri": "http://dacn:4000/vendor/theme/font-awesome/css/font-awesome.min.css",
							"method": "GET",
							"param": "Cross-Origin-Resource-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "38",
							"uri": "http://dacn:4000/vendor/theme/sb-admin.css",
							"method": "GET",
							"param": "Cross-Origin-Resource-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "13",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "Cross-Origin-Embedder-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "56",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "Cross-Origin-Embedder-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "14",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "Cross-Origin-Opener-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "57",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "Cross-Origin-Opener-Policy",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						}
					],
					"count": "9",
					"solution": "<p>Ensure that the application/web server sets the Cross-Origin-Resource-Policy header appropriately, and that it sets the Cross-Origin-Resource-Policy header to 'same-origin' for all web pages.</p><p>'same-site' is considered as less secured and should be avoided.</p><p>If resources must be shared, set the header to 'cross-origin'.</p><p>If possible, ensure that the end user uses a standards-compliant and modern web browser that supports the Cross-Origin-Resource-Policy header (https://caniuse.com/mdn-http_headers_cross-origin-resource-policy).</p>",
					"otherinfo": "",
					"reference": "<p>https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Cross-Origin-Embedder-Policy</p>",
					"cweid": "693",
					"wascid": "14",
					"sourceid": "3"
				},
				{
					"pluginid": "10063",
					"alertRef": "10063-1",
					"alert": "Permissions Policy Header Not Set",
					"name": "Permissions Policy Header Not Set",
					"riskcode": "1",
					"confidence": "2",
					"riskdesc": "Low (Medium)",
					"desc": "<p>Permissions Policy Header is an added layer of security that helps to restrict from unauthorized access or usage of browser/client features by web resources. This policy ensures the user privacy by limiting or specifying the features of the browsers can be used by the web resources. Permissions Policy provides a set of standard HTTP headers that allow website owners to limit which features of browsers can be used by the page such as camera, microphone, location, full screen etc.</p>",
					"instances":[ 
						{
							"id": "11",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "35",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "53",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "43",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "94",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "109",
							"uri": "http://dacn:4000/tutorial/a3",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "113",
							"uri": "http://dacn:4000/tutorial/a4",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "107",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "112",
							"uri": "http://dacn:4000/tutorial/a9",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "78",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						},
						{
							"id": "80",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": ""
						}
					],
					"count": "11",
					"solution": "<p>Ensure that your web server, application server, load balancer, etc. is configured to set the Permissions-Policy header.</p>",
					"otherinfo": "",
					"reference": "<p>https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Permissions-Policy</p><p>https://developer.chrome.com/blog/feature-policy/</p><p>https://scotthelme.co.uk/a-new-security-header-feature-policy/</p><p>https://w3c.github.io/webappsec-feature-policy/</p><p>https://www.smashingmagazine.com/2018/12/feature-policy/</p>",
					"cweid": "693",
					"wascid": "15",
					"sourceid": "3"
				},
				{
					"pluginid": "10037",
					"alertRef": "10037",
					"alert": "Server Leaks Information via \"X-Powered-By\" HTTP Response Header Field(s)",
					"name": "Server Leaks Information via \"X-Powered-By\" HTTP Response Header Field(s)",
					"riskcode": "1",
					"confidence": "2",
					"riskdesc": "Low (Medium)",
					"desc": "<p>The web/application server is leaking information via one or more \"X-Powered-By\" HTTP response headers. Access to such information may facilitate attackers identifying other frameworks/components your web application is reliant upon and the vulnerabilities such components may be subject to.</p>",
					"instances":[ 
						{
							"id": "23",
							"uri": "http://dacn:4000",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "5",
							"uri": "http://dacn:4000/",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "8",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "30",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "46",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "36",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "77",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "66",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "68",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "59",
							"uri": "http://dacn:4000/vendor/theme/font-awesome/css/font-awesome.min.css",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						},
						{
							"id": "28",
							"uri": "http://dacn:4000/vendor/theme/sb-admin.css",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "X-Powered-By: Express",
							"otherinfo": ""
						}
					],
					"count": "11",
					"solution": "<p>Ensure that your web server, application server, load balancer, etc. is configured to suppress \"X-Powered-By\" headers.</p>",
					"otherinfo": "",
					"reference": "<p>https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework</p><p>https://www.troyhunt.com/shhh-dont-let-your-response-headers/</p>",
					"cweid": "497",
					"wascid": "13",
					"sourceid": "10"
				},
				{
					"pluginid": "10021",
					"alertRef": "10021",
					"alert": "X-Content-Type-Options Header Missing",
					"name": "X-Content-Type-Options Header Missing",
					"riskcode": "1",
					"confidence": "2",
					"riskdesc": "Low (Medium)",
					"desc": "<p>The Anti-MIME-Sniffing header X-Content-Type-Options was not set to 'nosniff'. This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current (early 2014) and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.</p>",
					"instances":[ 
						{
							"id": "84",
							"uri": "http://dacn:4000/images/owasplogo.png",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "7",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "41",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "76",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "100",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "104",
							"uri": "http://dacn:4000/tutorial/a3",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "96",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "86",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.css",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "65",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "67",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "58",
							"uri": "http://dacn:4000/vendor/theme/font-awesome/css/font-awesome.min.css",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						},
						{
							"id": "22",
							"uri": "http://dacn:4000/vendor/theme/sb-admin.css",
							"method": "GET",
							"param": "x-content-type-options",
							"attack": "",
							"evidence": "",
							"otherinfo": "This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.\nAt \"High\" threshold this scan rule will not alert on client or server error responses."
						}
					],
					"count": "12",
					"solution": "<p>Ensure that the application/web server sets the Content-Type header appropriately, and that it sets the X-Content-Type-Options header to 'nosniff' for all web pages.</p><p>If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all, or that can be directed by the web application/web server to not perform MIME-sniffing.</p>",
					"otherinfo": "<p>This issue still applies to error type pages (401, 403, 500, etc.) as those pages are often still affected by injection issues, in which case there is still concern for browsers sniffing pages away from their actual content type.</p><p>At \"High\" threshold this scan rule will not alert on client or server error responses.</p>",
					"reference": "<p>https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/compatibility/gg622941(v=vs.85)</p><p>https://owasp.org/www-community/Security_Headers</p>",
					"cweid": "693",
					"wascid": "15",
					"sourceid": "47"
				},
				{
					"pluginid": "10111",
					"alertRef": "10111",
					"alert": "Authentication Request Identified",
					"name": "Authentication Request Identified",
					"riskcode": "0",
					"confidence": "3",
					"riskdesc": "Informational (High)",
					"desc": "<p>The given request has been identified as an authentication request. The 'Other Info' field contains a set of key=value lines which identify any relevant fields. If the request is in a context which has an Authentication Method set to \"Auto-Detect\" then this rule will change the authentication to match the request identified.</p>",
					"instances":[ 
						{
							"id": "141",
							"uri": "http://dacn:4000/login",
							"method": "POST",
							"param": "userName",
							"attack": "",
							"evidence": "password",
							"otherinfo": "userParam=userName\nuserValue=ZAP\npasswordParam=password\nreferer=http://dacn:4000/login\ncsrfToken=_csrf"
						}
					],
					"count": "1",
					"solution": "<p>This is an informational alert rather than a vulnerability and so there is nothing to fix.</p>",
					"otherinfo": "<p>userParam=userName</p><p>userValue=ZAP</p><p>passwordParam=password</p><p>referer=http://dacn:4000/login</p><p>csrfToken=_csrf</p>",
					"reference": "<p>https://www.zaproxy.org/docs/desktop/addons/authentication-helper/auth-req-id/</p>",
					"cweid": "-1",
					"wascid": "-1",
					"sourceid": "108"
				},
				{
					"pluginid": "10027",
					"alertRef": "10027",
					"alert": "Information Disclosure - Suspicious Comments",
					"name": "Information Disclosure - Suspicious Comments",
					"riskcode": "0",
					"confidence": "1",
					"riskdesc": "Informational (Low)",
					"desc": "<p>The response appears to contain suspicious comments which may help an attacker.</p>",
					"instances":[ 
						{
							"id": "71",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "userName",
							"otherinfo": "The following pattern was used: \\bUSERNAME\\b and was detected in likely comment: \"//localhost:4000/login -X POST --data 'userName=vyva%0aError: alex moldovan failed $1,000,000 transaction&password=Admin_123&_cs\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "91",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "userName",
							"otherinfo": "The following pattern was used: \\bUSERNAME\\b and was detected in likely comment: \"//localhost:4000/login -X POST --data 'userName=vyva%0aError: alex moldovan failed $1,000,000 transaction&password=Admin_123&_cs\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "110",
							"uri": "http://dacn:4000/tutorial/a2",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "user",
							"otherinfo": "The following pattern was used: \\bUSER\\b and was detected in likely comment: \"// Create user document\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "87",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "from",
							"otherinfo": "The following pattern was used: \\bFROM\\b and was detected in likely comment: \"// Prevent opening page in frame or iframe to protect from clickjacking\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "136",
							"uri": "http://dacn:4000/tutorial/a7",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "admin",
							"otherinfo": "The following pattern was used: \\bADMIN\\b and was detected in likely comment: \"//Middleware to check if user has admin rights\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "105",
							"uri": "http://dacn:4000/tutorial/a9",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "later",
							"otherinfo": "The following pattern was used: \\bLATER\\b and was detected in likely comment: \"//docs.npmjs.com/cli/v6/commands/npm-audit\">npm audit</a> is a vulnerability scanner built into the npm CLI (version 6 or later)\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "147",
							"uri": "http://dacn:4000/vendor/chart/raphael-min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "from",
							"otherinfo": "The following pattern was used: \\bFROM\\b and was detected in likely comment: \"//raphaeljs.com/\",\"letter-spacing\":0,opacity:1,path:\"M0,0\",r:0,rx:0,ry:0,src:\"\",stroke:\"#000\",\"stroke-dasharray\":\"\",\"stroke-line\", see evidence field for the suspicious comment/snippet."
						},
						{
							"id": "61",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "username",
							"otherinfo": "The following pattern was used: \\bUSERNAME\\b and was detected in likely comment: \"//,En=/^([\\w.+-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn=\"*/\".concat(\"*\");try{yn=o.href}catch(Ln){yn=a.cr\", see evidence field for the suspicious comment/snippet."
						}
					],
					"count": "8",
					"solution": "<p>Remove all comments that return information that may help an attacker and fix any underlying problems they refer to.</p>",
					"otherinfo": "<p>The following pattern was used: \\bUSERNAME\\b and was detected in likely comment: \"//localhost:4000/login -X POST --data 'userName=vyva%0aError: alex moldovan failed $1,000,000 transaction&password=Admin_123&_cs\", see evidence field for the suspicious comment/snippet.</p>",
					"reference": "",
					"cweid": "615",
					"wascid": "13",
					"sourceid": "22"
				},
				{
					"pluginid": "10109",
					"alertRef": "10109",
					"alert": "Modern Web Application",
					"name": "Modern Web Application",
					"riskcode": "0",
					"confidence": "2",
					"riskdesc": "Informational (Medium)",
					"desc": "<p>The application appears to be a modern web application. If you need to explore it automatically then the Ajax Spider may well be more effective than the standard one.</p>",
					"instances":[ 
						{
							"id": "6",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" style=\"font-size: larger\"><i class=\"fa fa-info-circle\"></i></a>",
							"otherinfo": "Links have been found that do not have traditional href attributes, which is an indication that this is a modern web application."
						},
						{
							"id": "72",
							"uri": "http://dacn:4000/tutorial",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A1 - Injection \n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-danger\">Exploitability: EASY</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-warning\">Detectability: AVERAGE</span>\n            <span class=\"label label-danger\">Technical Impact: SEVERE</span>\n        </div>\n    </div>\n</div>\n\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                Injection flaws occur when untrusted data is sent to an interpreter as part of a command or query. The attacker\u2019s hostile data can trick the interpreter into executing unintended commands or accessing data without proper authorization.\n            </div>\n        </div>\n        <!--\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Real World Attack Incident Examples</h3>\n            </div>\n            <div class=\"panel-body\">\n                Screencast here ...\n            </div>\n        </div>\n        -->\n    </div>\n</div>\n\n\n<!-- accordions -->\n<div class=\"panel-group\" id=\"accordion\">\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseOne\">\n                    <i class=\"fa fa-chevron-down\"></i>A1 - 1 Server Side JS Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n            <div class=\"panel-body\">\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        When\n                        <code>eval()</code>,\n                        <code>setTimeout()</code>,\n                        <code>setInterval()</code>,\n                        <code>Function()</code>are used to process user provided inputs, it can be exploited by an attacker to inject and execute malicious JavaScript code on server.\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Web applications using the JavaScript\n                            <code>eval()</code>function to parse the incoming data without any type of input validation are vulnerable to this attack. An attacker can inject arbitrary JavaScript code to be executed on the server. Similarly\n                            <code>setTimeout()</code>, and\n                            <code>setInterval()</code>functions can take code in string format as a first argument causing same issues as\n                            <code>eval()</code>.\n                        </p>\n                        <p>This vulnerability can be very critical and damaging by allowing attacker to send various types of commands.</p>\n                        <p>\n                            <b>Denial of Service Attack:</b>\n                        </p>\n                        <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/krOx9QWwcYw?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                        <p>\n                            An effective denial-of-service attack can be executed simply by sending the commands below to\n                            <code>eval()</code>function:\n                        </p>\n\n\n                        <pre>while(1)</pre>\n                        <p>\n                            This input will cause the target server's event loop to use 100% of its processor time and unable to process any other incoming requests until process is restarted.\n                        </p>\n                        <p>\n                            An alternative DoS attack would be to simply exit or kill the running process:\n                            <pre>process.exit()</pre> or <pre>process.kill(process.pid) </pre>\n                        </p>\n                        <p>\n                            <b>File System Access</b>\n                            <br/>\n                        </p>\n                        <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/Mr-Jh9bjSLo?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                        <p>\n                            Another potential goal of an attacker might be to read the contents of files from the server. For example, following two commands list the contents of the current directory and parent directory respectively:\n                        </p>\n                        <p>\n                            <pre>res.end(require('fs').readdirSync('.').toString())</pre>\n                            <pre>res.end(require('fs').readdirSync('..').toString()) </pre>\n                        </p>\n                        <p>\n                            Once file names are obtained, an attacker can issue the command below to view the actual contents of a file:\n                        </p>\n                        <p>\n                            <pre>res.end(require('fs').readFileSync(filename))</pre>\n                        </p>\n                        <p>\n                            An attacker can further exploit this vulnerability by writing and executing harmful binary files using\n                            <code>fs</code>and\n                            <code>child_process</code>modules.\n                        </p>\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        To prevent server-side js injection attacks:\n                        <ul>\n                            <li>Validate user inputs on server side before processing</li>\n                            <li>Do not use\n                                <code>eval()</code>function to parse user inputs. Avoid using other commands with similar effect, such as\n                                <code>setTimeOut()</code>,\n                                <code>setInterval()</code>, and\n                                <code>Function()</code>.\n                            </li>\n                            <li>\n                                For parsing JSON input, instead of using\n                                <code>eval()</code>, use a safer alternative such as\n                                <code>JSON.parse()</code>. For type conversions use type related\n                                <code>parseXXX()</code>methods.\n                            </li>\n                            <li>Include\n                                <code>\"use strict\"</code>at the beginning of a function, which enables <a target=\"_blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode\"> strict mode </a>within the enclosing function scope.</li>\n\n                        </ul>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>In\n                            <code>routes/contributions.js</code>, the\n                            <code>handleContributionsUpdate()</code>function insecurely uses\n                            <code>eval()</code>to convert user supplied contribution amounts to integer.\n                            <pre>\n        // Insecure use of eval() to parse inputs\n        var preTax = eval(req.body.preTax);\n        var afterTax = eval(req.body.afterTax);\n        var roth = eval(req.body.roth);\n                            </pre> This makes application vulnerable to SSJS attack. It can fixed simply by using\n                            <code>parseInt()</code>instead.\n                            <pre>\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        var preTax = parseInt(req.body.preTax);\n        var afterTax = parseInt(req.body.afterTax);\n        var roth = parseInt(req.body.roth);\n                            </pre>\n                        </p>\n                        <p>In addition, all functions begin with\n                            <code>use strict</code>pragma.\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Further Reading</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <ul>\n                            <li><a target=\"_blank\" href=\"https://media.blackhat.com/bh-us-11/Sullivan/BH_US_11_Sullivan_Server_Side_WP.pdf\">\u201CServerSide JavaScript Injection: Attacking NoSQL and Node.js\"</a> a whitepaper by Bryan Sullivan.</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /ssjs -->\n\n    <!-- DB Injection -->\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseTwo\">\n                    <i class=\"fa fa-chevron-down\"></i> A1 - 2 SQL and NoSQL Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseTwo\" class=\"panel-collapse\">\n            <div class=\"panel-body\">\n\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            SQL and NoSQL injections enable an attacker to inject code into the query that would be executed by the database. These flaws are introduced when software developers create dynamic database queries that include user supplied input.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>Both SQL and NoSQL databases are vulnerable to injection attack. Here is an example of equivalent attack in both cases, where attacker manages to retrieve admin user's record without knowing password:</p>\n                        <h5>1. SQL Injection</h5>\n                        <p>Lets consider an example SQL statement used to authenticate the user with username and password</p>\n                        <pre>SELECT * FROM accounts WHERE username = '$username' AND password = '$password'</pre>\n                        <p>If this statement is not prepared or properly handled when constructed, an attacker may be able to supply\n                            <code>admin' --</code>in the username field to access the admin user's account bypassing the condition that checks for the password. The resultant SQL query would looks like:</p>\n                        <pre>SELECT * FROM accounts WHERE username = 'admin' -- AND password = ''</pre>\n                        <br/>\n                        <h5>2. NoSQL Injection</h5>\n                        <p>The equivalent of above query for NoSQL MongoDB database is:</p>\n                        <pre>db.accounts.find({username: username, password: password});</pre>\n                        <p>While here we are no longer dealing with query language, an attacker can still achieve the same results as SQL injection by supplying JSON input object as below:</p>\n                        <pre>\n{\n    \"username\": \"admin\",\n    \"password\": {$gt: \"\"}\n}\n                        </pre>\n                        <p>In MongoDB,\n                            <code>$gt</code>selects those documents where the value of the field is greater than (i.e. >) the specified value. Thus above statement compares password in database with empty string for greatness, which returns\n                            <code>true</code>.</p>\n                        <p>The same results can be achieved using other comparison operator such as\n                            <code>$ne</code>.</p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">SSJS Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Server-side JavaScript Injection (SSJS) is an attack where JavaScript code is injected and executed in a server component. MongoDB specifically, is vulnerable to this attack when queries are run without proper sanitization.\n                        </p>\n\n                        <h5>$where operator</h5>\n                        <p>\n                            MongoDB's\n                            <code>$where</code> operator performs JavaScript expression evaluation on the MongoDB server. If the user is able to inject direct code into such queries then such an attack can take place\n                        </p>\n\n                        <p>\n                            Lets consider an example query:\n                        </p>\n                        <pre> db.allocationsCollection.find({ $where: \"this.userId == '\" + parsedUserId + \"' && \" + \"this.stocks > \" + \"'\" + threshold + \"'\" }); </pre>\n\n                        <p>\n                            The code will match all documents which have a\n                            <code>userId</code> field as specified by\n                            <code>parsedUserId</code> and a\n                            <code>stocks</code> field as specified by\n                            <code>threshold</code>. The problem is that these parameters are not validated, filtered, or sanitised, and vulnerable to SSJS Injection.\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        Here are some measures to prevent SQL / NoSQL injection attacks, or minimize impact if it happens:\n                        <ul>\n                            <li>Prepared Statements: For SQL calls, use prepared statements instead of building dynamic queries using string concatenation.</li>\n                            <li>Input Validation: Validate inputs to detect malicious values. For NoSQL databases, also validate input types against expected types</li>\n                            <li>Least Privilege: To minimize the potential damage of a successful injection attack, do not assign DBA or admin type access rights to your application accounts. Similarly minimize the privileges of the operating system account that the database process runs under.</li>\n                        </ul>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p><strong>Note: These vulnerabilities are not present when using an Atlas M0 cluster with NodeGoat.</strong></p>\n                        <p>The Allocations page of the demo application is vulnerable to NoSQL Injection. For example, set the stocks threshold filter to:</p>\n                        <pre>1'; return 1 == '1</pre>\n                        <p>This will retrieve allocations for all the users in the database.</p>\n                        <p>An attacker could also send the following input for the\n                            <code>threshold</code> field in the request's query, which will create a valid JavaScript expression and satisfy the\n                            <code> $where</code> query as well, resulting in a DoS attack on the MongoDB server:\n                        </p>\n                        <pre>http://localhost:4000/allocations/2?threshold=5';while(true){};' </pre>\n                        <p>\n                            You can also just drop the following into the Stocks Threshold input box:\n                        </p>\n                        <pre>';while(true){};'</pre>\n                        <p>For these vulnerabilities, bare minimum fixes can be found in\n                        <code>allocations.html</code> and\n                        <code>allocations-dao.js</code></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /NoSQL Injection -->\n\n    <!-- Log Injection -->\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseThree\">\n                    <i class=\"fa fa-chevron-down\"></i> A1 - 3 Log Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseThree\" class=\"panel-collapse\">\n            <div class=\"panel-body\">\n\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Log injection vulnerabilities enable an attacker to forge and tamper with an application's logs.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>An attacker may craft a malicious request that may deliberately fail, which the application will log, and when attacker's user input is unsanitized, the payload is sent as-is to the logging facility. Vulnerabilities may vary depending on the logging facility:</p>\n                        <h5>1. Log Forging (CRLF) </h5>\n                        <p>Lets consider an example where an application logs a failed attempt to login to the system. A very common example for this is as follows:\n                        </p>\n                        <pre>\nvar userName = req.body.userName;\nconsole.log('Error: attempt to login with invalid user: ', userName);\n                        </pre>\n                        <p>When user input is unsanitized and the output mechanism is an ordinary terminal stdout facility then the application will be vulnerable to CRLF injection, where an attacker can create a malicious payload as follows:\n                        <pre>\ncurl http://localhost:4000/login -X POST --data 'userName=vyva%0aError: alex moldovan failed $1,000,000 transaction&password=Admin_123&_csrf='\n                        </pre>\n                        Where the <code>userName</code> parameter is encoding in the request the LF symbol which will result in a new line to begin. Resulting log output will look as follows:\n                        <pre>\nError: attempt to login with invalid user:  vyva\nError: alex moldovan failed $1,000,000 transaction\n                        </pre>\n                        <br/>\n                        <h5>2. Log Injection Escalation </h5>\n                        <p>\n                            An attacker may craft malicious input in hope of an escalated attack where the target isn't the logs themselves, but rather the actual logging system. For example, if an application has a back-office web app that manages viewing and tracking the logs, then an attacker may send an XSS payload into the log, which may not result in log forging on the log itself, but when viewed by a system administrator on the log viewing web app then it may compromise it and result in XSS injection that if the logs app is vulnerable.\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n\n                        As always when dealing with user input:\n                        <ul>\n                            <li>\n                                Do not allow user input into logs\n                            </li>\n                            <li>\n                                Encode to proper context, or sanitize user input\n                            </li>\n                        </ul>\n\n                        Encoding example:\n                        <pre>\n// Step 1: Require a module that supports encoding\nvar ESAPI = require('node-esapi');\n// - Step 2: Encode the user input that will be logged in the correct context\n// following are a few examples:\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForHTML(userName));\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForJavaScript(userName));\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForURL(userName));\n                        </pre>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>For the above Log Injection vulnerability, example and fix can be found at\n                        <code>routes/session.js</code></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /Log Injection -->\n\n</div>\n<!-- end accordions -->\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "95",
							"uri": "http://dacn:4000/tutorial/a1",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A1 - Injection \n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-danger\">Exploitability: EASY</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-warning\">Detectability: AVERAGE</span>\n            <span class=\"label label-danger\">Technical Impact: SEVERE</span>\n        </div>\n    </div>\n</div>\n\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                Injection flaws occur when untrusted data is sent to an interpreter as part of a command or query. The attacker\u2019s hostile data can trick the interpreter into executing unintended commands or accessing data without proper authorization.\n            </div>\n        </div>\n        <!--\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Real World Attack Incident Examples</h3>\n            </div>\n            <div class=\"panel-body\">\n                Screencast here ...\n            </div>\n        </div>\n        -->\n    </div>\n</div>\n\n\n<!-- accordions -->\n<div class=\"panel-group\" id=\"accordion\">\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseOne\">\n                    <i class=\"fa fa-chevron-down\"></i>A1 - 1 Server Side JS Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n            <div class=\"panel-body\">\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        When\n                        <code>eval()</code>,\n                        <code>setTimeout()</code>,\n                        <code>setInterval()</code>,\n                        <code>Function()</code>are used to process user provided inputs, it can be exploited by an attacker to inject and execute malicious JavaScript code on server.\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Web applications using the JavaScript\n                            <code>eval()</code>function to parse the incoming data without any type of input validation are vulnerable to this attack. An attacker can inject arbitrary JavaScript code to be executed on the server. Similarly\n                            <code>setTimeout()</code>, and\n                            <code>setInterval()</code>functions can take code in string format as a first argument causing same issues as\n                            <code>eval()</code>.\n                        </p>\n                        <p>This vulnerability can be very critical and damaging by allowing attacker to send various types of commands.</p>\n                        <p>\n                            <b>Denial of Service Attack:</b>\n                        </p>\n                        <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/krOx9QWwcYw?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                        <p>\n                            An effective denial-of-service attack can be executed simply by sending the commands below to\n                            <code>eval()</code>function:\n                        </p>\n\n\n                        <pre>while(1)</pre>\n                        <p>\n                            This input will cause the target server's event loop to use 100% of its processor time and unable to process any other incoming requests until process is restarted.\n                        </p>\n                        <p>\n                            An alternative DoS attack would be to simply exit or kill the running process:\n                            <pre>process.exit()</pre> or <pre>process.kill(process.pid) </pre>\n                        </p>\n                        <p>\n                            <b>File System Access</b>\n                            <br/>\n                        </p>\n                        <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/Mr-Jh9bjSLo?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                        <p>\n                            Another potential goal of an attacker might be to read the contents of files from the server. For example, following two commands list the contents of the current directory and parent directory respectively:\n                        </p>\n                        <p>\n                            <pre>res.end(require('fs').readdirSync('.').toString())</pre>\n                            <pre>res.end(require('fs').readdirSync('..').toString()) </pre>\n                        </p>\n                        <p>\n                            Once file names are obtained, an attacker can issue the command below to view the actual contents of a file:\n                        </p>\n                        <p>\n                            <pre>res.end(require('fs').readFileSync(filename))</pre>\n                        </p>\n                        <p>\n                            An attacker can further exploit this vulnerability by writing and executing harmful binary files using\n                            <code>fs</code>and\n                            <code>child_process</code>modules.\n                        </p>\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        To prevent server-side js injection attacks:\n                        <ul>\n                            <li>Validate user inputs on server side before processing</li>\n                            <li>Do not use\n                                <code>eval()</code>function to parse user inputs. Avoid using other commands with similar effect, such as\n                                <code>setTimeOut()</code>,\n                                <code>setInterval()</code>, and\n                                <code>Function()</code>.\n                            </li>\n                            <li>\n                                For parsing JSON input, instead of using\n                                <code>eval()</code>, use a safer alternative such as\n                                <code>JSON.parse()</code>. For type conversions use type related\n                                <code>parseXXX()</code>methods.\n                            </li>\n                            <li>Include\n                                <code>\"use strict\"</code>at the beginning of a function, which enables <a target=\"_blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode\"> strict mode </a>within the enclosing function scope.</li>\n\n                        </ul>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>In\n                            <code>routes/contributions.js</code>, the\n                            <code>handleContributionsUpdate()</code>function insecurely uses\n                            <code>eval()</code>to convert user supplied contribution amounts to integer.\n                            <pre>\n        // Insecure use of eval() to parse inputs\n        var preTax = eval(req.body.preTax);\n        var afterTax = eval(req.body.afterTax);\n        var roth = eval(req.body.roth);\n                            </pre> This makes application vulnerable to SSJS attack. It can fixed simply by using\n                            <code>parseInt()</code>instead.\n                            <pre>\n        //Fix for A1 -1 SSJS Injection attacks - uses alternate method to eval\n        var preTax = parseInt(req.body.preTax);\n        var afterTax = parseInt(req.body.afterTax);\n        var roth = parseInt(req.body.roth);\n                            </pre>\n                        </p>\n                        <p>In addition, all functions begin with\n                            <code>use strict</code>pragma.\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Further Reading</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <ul>\n                            <li><a target=\"_blank\" href=\"https://media.blackhat.com/bh-us-11/Sullivan/BH_US_11_Sullivan_Server_Side_WP.pdf\">\u201CServerSide JavaScript Injection: Attacking NoSQL and Node.js\"</a> a whitepaper by Bryan Sullivan.</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /ssjs -->\n\n    <!-- DB Injection -->\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseTwo\">\n                    <i class=\"fa fa-chevron-down\"></i> A1 - 2 SQL and NoSQL Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseTwo\" class=\"panel-collapse\">\n            <div class=\"panel-body\">\n\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            SQL and NoSQL injections enable an attacker to inject code into the query that would be executed by the database. These flaws are introduced when software developers create dynamic database queries that include user supplied input.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>Both SQL and NoSQL databases are vulnerable to injection attack. Here is an example of equivalent attack in both cases, where attacker manages to retrieve admin user's record without knowing password:</p>\n                        <h5>1. SQL Injection</h5>\n                        <p>Lets consider an example SQL statement used to authenticate the user with username and password</p>\n                        <pre>SELECT * FROM accounts WHERE username = '$username' AND password = '$password'</pre>\n                        <p>If this statement is not prepared or properly handled when constructed, an attacker may be able to supply\n                            <code>admin' --</code>in the username field to access the admin user's account bypassing the condition that checks for the password. The resultant SQL query would looks like:</p>\n                        <pre>SELECT * FROM accounts WHERE username = 'admin' -- AND password = ''</pre>\n                        <br/>\n                        <h5>2. NoSQL Injection</h5>\n                        <p>The equivalent of above query for NoSQL MongoDB database is:</p>\n                        <pre>db.accounts.find({username: username, password: password});</pre>\n                        <p>While here we are no longer dealing with query language, an attacker can still achieve the same results as SQL injection by supplying JSON input object as below:</p>\n                        <pre>\n{\n    \"username\": \"admin\",\n    \"password\": {$gt: \"\"}\n}\n                        </pre>\n                        <p>In MongoDB,\n                            <code>$gt</code>selects those documents where the value of the field is greater than (i.e. >) the specified value. Thus above statement compares password in database with empty string for greatness, which returns\n                            <code>true</code>.</p>\n                        <p>The same results can be achieved using other comparison operator such as\n                            <code>$ne</code>.</p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">SSJS Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Server-side JavaScript Injection (SSJS) is an attack where JavaScript code is injected and executed in a server component. MongoDB specifically, is vulnerable to this attack when queries are run without proper sanitization.\n                        </p>\n\n                        <h5>$where operator</h5>\n                        <p>\n                            MongoDB's\n                            <code>$where</code> operator performs JavaScript expression evaluation on the MongoDB server. If the user is able to inject direct code into such queries then such an attack can take place\n                        </p>\n\n                        <p>\n                            Lets consider an example query:\n                        </p>\n                        <pre> db.allocationsCollection.find({ $where: \"this.userId == '\" + parsedUserId + \"' && \" + \"this.stocks > \" + \"'\" + threshold + \"'\" }); </pre>\n\n                        <p>\n                            The code will match all documents which have a\n                            <code>userId</code> field as specified by\n                            <code>parsedUserId</code> and a\n                            <code>stocks</code> field as specified by\n                            <code>threshold</code>. The problem is that these parameters are not validated, filtered, or sanitised, and vulnerable to SSJS Injection.\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        Here are some measures to prevent SQL / NoSQL injection attacks, or minimize impact if it happens:\n                        <ul>\n                            <li>Prepared Statements: For SQL calls, use prepared statements instead of building dynamic queries using string concatenation.</li>\n                            <li>Input Validation: Validate inputs to detect malicious values. For NoSQL databases, also validate input types against expected types</li>\n                            <li>Least Privilege: To minimize the potential damage of a successful injection attack, do not assign DBA or admin type access rights to your application accounts. Similarly minimize the privileges of the operating system account that the database process runs under.</li>\n                        </ul>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p><strong>Note: These vulnerabilities are not present when using an Atlas M0 cluster with NodeGoat.</strong></p>\n                        <p>The Allocations page of the demo application is vulnerable to NoSQL Injection. For example, set the stocks threshold filter to:</p>\n                        <pre>1'; return 1 == '1</pre>\n                        <p>This will retrieve allocations for all the users in the database.</p>\n                        <p>An attacker could also send the following input for the\n                            <code>threshold</code> field in the request's query, which will create a valid JavaScript expression and satisfy the\n                            <code> $where</code> query as well, resulting in a DoS attack on the MongoDB server:\n                        </p>\n                        <pre>http://localhost:4000/allocations/2?threshold=5';while(true){};' </pre>\n                        <p>\n                            You can also just drop the following into the Stocks Threshold input box:\n                        </p>\n                        <pre>';while(true){};'</pre>\n                        <p>For these vulnerabilities, bare minimum fixes can be found in\n                        <code>allocations.html</code> and\n                        <code>allocations-dao.js</code></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /NoSQL Injection -->\n\n    <!-- Log Injection -->\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseThree\">\n                    <i class=\"fa fa-chevron-down\"></i> A1 - 3 Log Injection\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseThree\" class=\"panel-collapse\">\n            <div class=\"panel-body\">\n\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            Log injection vulnerabilities enable an attacker to forge and tamper with an application's logs.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>An attacker may craft a malicious request that may deliberately fail, which the application will log, and when attacker's user input is unsanitized, the payload is sent as-is to the logging facility. Vulnerabilities may vary depending on the logging facility:</p>\n                        <h5>1. Log Forging (CRLF) </h5>\n                        <p>Lets consider an example where an application logs a failed attempt to login to the system. A very common example for this is as follows:\n                        </p>\n                        <pre>\nvar userName = req.body.userName;\nconsole.log('Error: attempt to login with invalid user: ', userName);\n                        </pre>\n                        <p>When user input is unsanitized and the output mechanism is an ordinary terminal stdout facility then the application will be vulnerable to CRLF injection, where an attacker can create a malicious payload as follows:\n                        <pre>\ncurl http://localhost:4000/login -X POST --data 'userName=vyva%0aError: alex moldovan failed $1,000,000 transaction&password=Admin_123&_csrf='\n                        </pre>\n                        Where the <code>userName</code> parameter is encoding in the request the LF symbol which will result in a new line to begin. Resulting log output will look as follows:\n                        <pre>\nError: attempt to login with invalid user:  vyva\nError: alex moldovan failed $1,000,000 transaction\n                        </pre>\n                        <br/>\n                        <h5>2. Log Injection Escalation </h5>\n                        <p>\n                            An attacker may craft malicious input in hope of an escalated attack where the target isn't the logs themselves, but rather the actual logging system. For example, if an application has a back-office web app that manages viewing and tracking the logs, then an attacker may send an XSS payload into the log, which may not result in log forging on the log itself, but when viewed by a system administrator on the log viewing web app then it may compromise it and result in XSS injection that if the logs app is vulnerable.\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n\n                        As always when dealing with user input:\n                        <ul>\n                            <li>\n                                Do not allow user input into logs\n                            </li>\n                            <li>\n                                Encode to proper context, or sanitize user input\n                            </li>\n                        </ul>\n\n                        Encoding example:\n                        <pre>\n// Step 1: Require a module that supports encoding\nvar ESAPI = require('node-esapi');\n// - Step 2: Encode the user input that will be logged in the correct context\n// following are a few examples:\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForHTML(userName));\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForJavaScript(userName));\nconsole.log('Error: attempt to login with invalid user: %s', ESAPI.encoder().encodeForURL(userName));\n                        </pre>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>For the above Log Injection vulnerability, example and fix can be found at\n                        <code>routes/session.js</code></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /Log Injection -->\n\n</div>\n<!-- end accordions -->\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "111",
							"uri": "http://dacn:4000/tutorial/a2",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A2-Broken Authentication and Session Management \n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-warning\">Exploitability: AVERAGE</span>\n            <span class=\"label label-danger\">Prevalence: WIDESPREAD</span>\n            <span class=\"label label-warning\">Detectability: AVERAGE</span>\n            <span class=\"label label-danger\">Technical Impact: SEVERE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    In this attack, an attacker (who can be anonymous external attacker, a user with own account who may attempt to steal data from accounts, or an insider wanting to disguise his or her actions) uses leaks or flaws in the authentication or session management functions to impersonate other users. Application functions related to authentication and session management are often not implemented correctly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users\u2019 identities.\n                </p>\n                <p>\n                    Developers frequently build custom authentication and session management schemes, but building these correctly is hard. As a result, these custom schemes frequently have flaws in areas such as logout, password management, timeouts, remember me, secret question, account update, etc. Finding such flaws can sometimes be difficult, as each implementation is unique.\n                </p>\n            </div>\n\n        </div>\n        <!--\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Real World Attack Incident Examples</h3>\n            </div>\n            <div class=\"panel-body\">\n                Screencast here ...\n            </div>\n        </div>\n-->\n    </div>\n</div>\n\n<!-- accordions -->\n<div class=\"panel-group\" id=\"accordion\">\n\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseTwo\">\n                    <i class=\"fa fa-chevron-down\"></i> A2 - 1 Session Management\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseTwo\" class=\"panel-collapse collapse in\">\n            <div class=\"panel-body\">\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        Session management is a critical piece of application security. It is broader risk, and requires developers take care of protecting session id, user credential secure storage, session duration, and protecting critical session data in transit.\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p><b>Scenario #1:</b> Application timeouts aren't set properly. User uses a public computer to access site. Instead of selecting \u201Clogout\u201D the user simply closes the browser tab and walks away. Attacker uses the same browser an hour later, and that browser is still authenticated.</p>\n\n                        <p><b>Scenario #2: </b>Attacker acts as a man-in-middle and acquires user's session id from network traffic. Then uses this authenticated session id to connect to application without needing to enter user name and password.</p>\n\n                        <p><b>Scenario #3: </b>Insider or external attacker gains access to the system's password database. User passwords are not properly hashed, exposing every users' password to the attacker.</p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        Session management related security issues can be prevented by taking these measures:\n                        <ul>\n                            <li>User authentication credentials should be protected when stored using hashing or encryption.</li>\n                            <li>Session IDs should not be exposed in the URL (e.g., URL rewriting).</li>\n                            <li>Session IDs should timeout. User sessions or authentication tokens should get properly invalidated during logout.</li>\n                            <li>Session IDs should be recreated after successful login.</li>\n                            <li>Passwords, session IDs, and other credentials should not be sent over unencrypted connections.</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Examples</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>In the insecure demo app, following issues exists:</p>\n                        <h3>1. Protecting user credentials</h3>\n                        <p>password gets stored in database in plain text . Here is related code in\n                            <code>data/user-dao.js</code>\n                            <code>addUser()</code>method:\n                            <pre>\n// Create user document\nvar user = {\n    userName: userName,\n    firstName: firstName,\n    lastName: lastName,\n    password: password //received from request param\n};\n                        </pre> To secure it, handle password storage in a safer way by using one way encryption using salt hashing as below:</p>\n                        <pre>\n// Generate password hash\nvar salt = bcrypt.genSaltSync();\nvar passwordHash = bcrypt.hashSync(password, salt);\n\n// Create user document\nvar user = {\n    userName: userName,\n    firstName: firstName,\n    lastName: lastName,\n    password: passwordHash\n};\n                        </pre> This hash password can not be decrypted, hence more secure. To compare the password when user logs in, the user entered password gets converted to hash and compared with the hash in storage.\n\n                        <pre>\nif (bcrypt.compareSync(password, user.password)) {\n    callback(null, user);\n} else {\n    callback(invalidPasswordError, null);\n}\n                        </pre> Note: The bcrypt module also provides asynchronous methods for creating and comparing hash.\n                        <br/>\n                        <br/>\n                        <h3>2. Session timeout and protecting cookies in transit</h3>\n\n                        <p>The insecure demo application does not contain any provision to timeout user session. The session stays active until user explicitly logs out.</p>\n\n                        <p>In addition to that, the app does not prevent cookies being accessed in script, making application vulnerable to Cross Site Scripting (XSS) attacks. Also cookies are not prevented to get sent on insecure HTTP connection.</p>\n\n                        <p>To secure the application:</p>\n                        <p>1. Use session based timeouts, terminate session when browser closes.</p>\n                        <pre>\n// Enable session management using express middleware\napp.use(express.cookieParser());\n </pre>\n                        <p>2. In addition, sets\n                            <code>HTTPOnly</code>HTTP header preventing cookies being accessed by scripts. The application used HTTPS secure connections, and cookies are configured to be sent only on Secure HTTPS connections by setting\n                            <code>Secure</code>flag.\n                            <pre>\napp.use(express.session({\n    secret: \"s3Cur3\",\n    cookie: {\n        httpOnly: true,\n        secure: true\n    }\n}));\n                        </pre>\n                        </p>\n                        <p>\n                            3. When user clicks logout, destroy the session and session cookie\n                            <pre>\nreq.session.destroy(function() {\n    res.redirect(\"/\");\n});\n                        </pre> Note: The example code uses\n                            <code>MemoryStore</code>to manage session data, which is not designed for production environment, as it will leak memory, and will not scale past a single process. Use database based storage MongoStore or RedisStore for production. Alternatively, sessions can be managed using popular passport module.\n                        <br/>\n                        <br/>\n                        <h3>3. Session hijacking</h3>\n\n                        <p>The insecure demo application does not regenerate a new session id upon user's login, therefore rendering a vulnerability of session hijacking if an attacker is able to somehow steal the cookie with the session id and use it.\n\n                        <p>Upon login, a security best practice with regards to cookies session management would be to regenerate the session id so that if an id was already created for a user on an insecure medium (i.e: non-HTTPS website or otherwise), or if an attacker was able to get their hands on the cookie id before the user logged-in, then the old session id will render useless as the logged-in user with new privileges holds a new session id now.\n                    </p>\n\n                        <p>To secure the application:</p>\n                        <p>1. Re-generate a new session id upon login (and best practice is to keep regenerating them\nupon requests or at least upon sensitive actions like a user's password reset.\n\n                            Re-generate a session id as follows:\n                            By wrapping the below code as a function callback for the method req.session.regenerate()\n                            <pre>\nreq.session.regenerate(function() {\n\n  req.session.userId = user._id;\n\n  if (user.isAdmin) {\n    return res.redirect(\"/benefits\");\n  } else {\n    return res.redirect(\"/dashboard\");\n  }\n\n})\n                        </pre>\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Further Reading</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <ul>\n                            <li><a href=\"https://npmjs.org/package/helmet\">Helmet</a> Security header middleware collection for express</li>\n                            <li><a href=\"http://recxltd.blogspot.sg/2012/03/seven-web-server-http-headers-that.html\">Seven Web Server HTTP Headers that Improve Web Application Security for Free</a>\n                            </li>\n                            <li><a href=\"http://passportjs.org/guide/authenticate/\">Passport</a> authentication middleware</li>\n                            <li><a href=\"http://en.wikipedia.org/wiki/Session_fixation\">CWE-384: Session Fixation</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </div>\n    <!-- /Session Management -->\n\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h4 class=\"panel-title\">\n                <a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapseOne\">\n                    <i class=\"fa fa-chevron-down\"></i> A2 - 2 Password Guessing Attacks\n                </a>\n            </h4>\n        </div>\n        <div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n            <div class=\"panel-body\">\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        Implementing a robust minimum password criteria (minimum length and complexity) can make it difficult for attacker to guess password.\n                    </div>\n                </div>\n                <!--  \n                <div class=\"panel panel-info\"> \n                    <div class=\"panel-heading\"> \n                        <h3 class=\"panel-title\">Attack Scenario Demo</h3> \n                    </div> \n                    <div class=\"panel-body\"> \n                        Screencast showing how attack can manifest in the target application ... \n                    </div> \n                </div> \n                -->\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            The attacker can exploit this vulnerability by brute force password guessing, more likely using tools that generate random passwords.\n                        </p>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p><b>Password length</b>\n                        </p>\n                        <p>Minimum passwords length should be at least eight (8) characters long. Combining this length with complexity makes a password difficult to guess and/or brute force.</p>\n                        <p><b>Password complexity</b>\n                        </p>\n                        <p>Password characters should be a combination of alphanumeric characters. Alphanumeric characters consist of letters, numbers, punctuation marks, mathematical and other conventional symbols.</p>\n                        <p><b>Username/Password Enumeration</b>\n                        </p>\n                        <p>Authentication failure responses should not indicate which part of the authentication data was incorrect. For example, instead of \"Invalid username\" or \"Invalid password\", just use \"Invalid username and/or password\" for both. Error responses must be truly identical in both display and source code</p>\n\n                        <p><b>Additional Measures</b>\n                        </p>\n                        <p>\n                            <ul>\n                                <li>For additional protection against brute forcing, enforce account disabling after an established number of invalid login attempts (e.g., five attempts is common). The account must be disabled for a period of time sufficient to discourage brute force guessing of credentials, but not so long as to allow for a denial-of-service attack to be performed.</li>\n                                <li>Only send non-temporary passwords over an encrypted connection or as encrypted data, such as in an encrypted email. Temporary passwords associated with email resets may be an exception. Enforce the changing of temporary passwords on the next use. Temporary passwords and links should have a short expiration time.</li>\n                            </ul>\n                    </div>\n                </div>\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Source Code Example</h3>\n                    </div>\n                    <div class=\"panel-body\">\n                        <p>\n                            The demo application doesn't enforce strong password. In routes/session.js\n                            <code>validateSignup()</code>method, the regex for password enforcement is simply <pre>var PASS_RE = /^.{1,20}$/;</pre>\n                        </p>\n                        <p>\n                            A stronger password can be enforced using the regex below, which requires at least 8 character password with numbers and both lowercase and uppercase letters.\n                            <pre>var PASS_RE =/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;</pre>\n                        </p>\n                        <p>\n                            Another issue, in routes/session.js, the\n                            <code>handleLoginRequest()</code>enumerated whether password was incorrect or user doesn't exist.This information can be valuable to an attacker with brute forcing attempts. This can be easily fixed using a generic error message such as \"Invalid username and/or password\".\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- /Password Complexity -->\n\n\n</div>\n<!-- end accordions -->\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "97",
							"uri": "http://dacn:4000/tutorial/a3",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A3-Cross-Site Scripting (XSS)\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-warning\">Exploitability: AVERAGE</span>\n            <span class=\"label label-danger\">Prevalence: VERY WIDESPREAD</span>\n            <span class=\"label label-danger\">Detectability: EASY</span>\n            <span class=\"label label-warning\">Technical Impact: MODERATE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                XSS flaws occur whenever an application takes untrusted data and sends it to a web browser without proper validation or escaping.\n                XSS allows attackers to execute scripts in the victims' browser, which can access any cookies, session tokens,\n                or other sensitive information retained by the browser, or redirect user to malicious sites.\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    There are two types of XSS flaws:\n                </p>\n\n                <ol>\n                    <li>Reflected XSS: The malicious data is echoed back by the server in an immediate response to an HTTP\n                        request from the victim.</li>\n                    <li>Stored XSS: The malicious data is stored on the server or on browser (using HTML5 local storage,\n                        for example), and later gets embedded in HTML page provided to the victim.</li>\n                </ol>\n\n                <p>Each of reflected and stored XSS can occur on the server or on the client (which is also known as DOM\n                    based XSS), depending on when the malicious data gets injected in HTML markup.</p>\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                <ol>\n                    <li>\n                        <p><b> Input validation and sanitization:</b> Input validation and data sanitization are the first\n                            line of defense against untrusted data. Apply white list validation wherever possible.</p>\n                    </li>\n                    <li>\n                        <p> <b> Output encoding for correct context: </b>When a browser is rendering HTML and any other associated\n                            content like CSS, javascript etc., it follows different rendering rules for each context. Hence\n                            <i>Context-sensitive output encoding</i> is absolutely critical for mitigating risk of XSS.</p>\n                        Here are the details about applying correct encoding in each context:\n                        <table class=\"table table-bordered table-hover\">\n                            <tbody>\n                                <tr>\n                                    <th>Context</th>\n                                    <th>Code Sample</th>\n                                    <th>Encoding Type</th>\n                                </tr>\n                                <tr>\n                                    <td>HTML Entity</td>\n                                    <td>&lt;span&gt;\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>&lt;/span&gt;</td>\n                                    <td>Convert &amp; to &amp;amp;\n                                        <br>Convert &lt; to &amp;lt;\n                                        <br>Convert &gt; to &amp;gt;\n                                        <br>Convert \" to &amp;quot;\n                                        <br>Convert ' to &amp;#x27;\n                                        <br>Convert / to &amp;#x2F;\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>HTML Attribute Encoding</td>\n                                    <td>&lt;input type=\"text\" name=\"fname\" value=\"\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>\"&gt;</td>\n                                    <td>Except for alphanumeric characters, escape all characters with the HTML Entity &amp;#xHH;\n                                        format, including spaces. (HH = Hex Value)\n                                        <br/>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>URI Encoding</td>\n                                    <td>&lt;a href=\"/site/search?value=\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>\"&gt;clickme&lt;/a&gt;</td>\n                                    <td>Except for alphanumeric characters, escape all characters with ASCII values less\n                                        than 256 with the HTML Entity &amp;#xHH; format, including spaces. (HH = Hex Value)\n                                        <br/>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>JavaScript Encoding</td>\n                                    <td>&lt;script&gt;var currentValue='\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>';&lt;/script&gt;\n                                        <br>&lt;script&gt;someFunction('\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>');&lt;/script&gt;\n                                    </td>\n                                    <td>Ensure JavaScript variables are quoted. Except for alphanumeric characters, escape\n                                        all characters with ASCII values less than 256 with \\uXXXX unicode escaping format\n                                        (X = Integer), or in xHH (HH = HEX Value) encoding format.\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>CSS Encoding</td>\n                                    <td>&lt;div style=\"width:\n                                        <span style=\"color:red;\">UNTRUSTED DATA</span>;\"&gt;Selection&lt;/div&gt;</td>\n                                    <td>Except for alphanumeric characters, escape all characters with ASCII values less\n                                        than 256 with the \\HH (HH= Hex Value) escaping format.\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </li>\n                    <li>\n                        <p><b>HTTPOnly cookie flag:</b> Preventing all XSS flaws in an application is hard. To help mitigate\n                            the impact of an XSS flaw on your site, set the HTTPOnly flag on session cookie and any custom\n                            cookies that are not required to be accessed by JavaScript.\n                        </p>\n                    </li>\n                    <li>\n                        <p><b>Implement Content Security Policy (CSP):</b> CSP is a browser side mechanism which allows creating\n                            whitelists for client side resources used by the web application, e.g. JavaScript, CSS, images,\n                            etc. CSP via special HTTP header instructs the browser to only execute or render resources from\n                            those sources. For example, the CSP header below allows content only from example site's own\n                            domain (mydomain.com) and all its sub domains.\n                            <pre>Content-Security-Policy: default-src 'self' *.mydomain.com</pre>\n\n                        </p>\n                    </li>\n                    <li> <b>Apply encoding on both client and server side: </b> It is essential to apply encoding on both\n                        client and server side to mitigate DOM based XSS attack, in which untrusted data never leaves the\n                        browser.\n                </ol>\n                <p>Source: XSS Prevention Cheat Sheet[1]\n                </p>\n            </div>\n        </div>\n        <div id=\"source-code-example\" class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Source Code Example</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    The demo web application is vulnerable to stored XSS attack on profiles form. On form submit, the first and last name field\n                    values are submitted to the server, and without any validation get saved in database. The values are\n                    then sent back to the browser without proper escaping to be shown at the top right menu.\n                </p>\n                <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/KvZ5jdg083M?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n\n                <p>Two measures can be taken to mitigate XSS risk:\n\n                    <ol>\n                        <li>In\n                            <code>server.js</code>, enable the HTML Encoding using template engine's auto escape flag.\n                            <pre>\nswig.init({\n    root: __dirname + \"/app/views\",\n    autoescape: true //default value\n});\n                            </pre>\n                        </li>\n                        <li>\n                            Set HTTPOnly flag for session cookie while configuring the express session\n                            <pre>\n// Enable session management using express middleware\napp.use(express.session({\n    secret: \"s3Cur3\",\n    cookie: {\n        httpOnly: true,\n        secure: true\n    }\n}));\n                            </pre>\n                        </li>\n                    </ol>\n                    There were no additional contexts that needed encoding on the demo page; otherwise, it is necessary to encode for correct\n                    context depending on where data get placed at.\n\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Output Encoding Context</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    An important observation when handling output encoding to prevent XSS is the notion of context.\n                </p>\n\n                <p>\n                    When output encoding is performed, it must match the context in which it is being injected to. For example, if a user input\n                    is being injected to an HTML element then it will require different encoding semantics to escape malicious\n                    input than if it were injected to say an HTML attribute or a JavaScript context altogether (such as in\n                    a script tag).\n                </p>\n\n                <p>\n                    An example for how to take advantage and exploit this mis-understanding exists on the profile page. See code references in\n                    <code>profile.js</code> and <code>profile.html</code>\n                </p>\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Further Reading</h3>\n            </div>\n            <div class=\"panel-body\">\n                <ol>\n                    <li>\n                        <a href=\"https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet\">XSS Prevention\n                            Cheat Sheet</a>\n                    </li>\n                    <li>\n                        <a href=\"https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Server_XS\">Types of Cross-Site\n                            Scripting\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet#STYLE_sheet \">XSS Filter\n                            Evasion Cheat Sheet</a>\n                    </li>\n                    <li>\n                        <a href=\"https://www.owasp.org/images/c/c5/Unraveling_some_Mysteries_around_DOM-based_XSS.pdf \">Unraveling\n                            some of the Mysteries around DOM-based XSS</a>\n                    </li>\n                </ol>\n            </div>\n        </div>\n\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "102",
							"uri": "http://dacn:4000/tutorial/a4",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A4-Insecure Direct Object References\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-danger\">Exploitability: EASY</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-danger\">Detectability: EASY</span>\n            <span class=\"label label-warning\">Technical Impact: MODERATE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                A direct object reference occurs when a developer exposes a reference to an internal implementation object, such as a file, directory, or database key. Without an access control check or other protection, attackers can manipulate these references to access unauthorized data.</div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    If an applications uses the actual name or key of an object when generating web pages, and doesn't verify if the user is authorized for the target object, this can result in an insecure direct object reference flaw. An attacker can exploit such flaws by manipulating parameter values. Unless object references are unpredictable, it is easy for an attacker to access all available data of that type.\n                </p>\n                <p>\n                    For example, the insure demo application uses userid as part of the url to access the allocations (/allocations/{id}). An attacker can manipulate id value and access other user's allocation information.\n                    <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/KFTRMw5F_eg?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                </p>\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                <ol>\n                    <li>\n                        <b>Check access: </b> Each use of a direct object reference from an untrusted source must include an access control check to ensure the user is authorized for the requested object.\n                    </li>\n                    <li>\n                        <b>Use per user or session indirect object references:</b> Instead of exposing actual database keys as part of the access links, use temporary per-user indirect reference. For example, instead of using the resource\u2019s database key, a drop down list of six resources authorized for the current user could use the numbers 1 to 6 or unique random numbers to indicate which value the user selected. The application has to map the per-user indirect reference back to the actual database key on the server.\n                    </li>\n                    <li> <b>Testing and code analysis:</b> Testers can easily manipulate parameter values to detect such flaws. In addition, code analysis can quickly show whether authorization is properly verified.\n                    </li>\n                </ol>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Source Code Example</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    In\n                    <code>routes/allocations.js</code>, the insecure application takes user id from url to fetch the allocations.\n                    <pre>\n    var userId = req.params.userId;\n    allocationsDAO.getByUserId(userId, function(error, allocations) {\n\n        if (error) return next(error);\n\n        return res.render(\"allocations\", allocations);\n    });\n                </pre>\n                </p>\n                <p>\n                    A safer alternative is to always retrieve allocations for logged in user (using\n                    <code>req.session.userId</code>)instead of taking it from url.\n                </p>\n            </div>\n        </div>\n\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "90",
							"uri": "http://dacn:4000/tutorial/a5",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A5-Security Misconfiguration\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-danger\">Exploitability: EASY</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-danger\">Detectability: EASY</span>\n            <span class=\"label label-warning\">Technical Impact: MODERATE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>This vulnerability allows an attacker to accesses default accounts, unused pages, unpatched flaws, unprotected files and directories, etc. to gain unauthorized access to or knowledge of the system.</p>\n                <p>Security misconfiguration can happen at any level of an application stack, including the platform, web server, application server, database, framework, and custom code.</p>\n                <p>Developers and system administrators need to work together to ensure that the entire stack is configured properly.</p>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n\n                This vulnerability encompasses a broad category of attacks, but here are some ways attacker can exploit it:\n                <ol>\n                    <li>If application server is configured to run as root, an attacker can run malicious scripts (by exploiting eval family functions) or start new child processes on server</li>\n                    <li>Read, write, delete files on file system. Create and run binary files</li>\n                    <li>If the server is misconfigured to leak internal implementation details via cookie names or HTTP response headers, then attacker can use this information towards building site's risk profile and finding vulnerabilities\n                    </li>\n                    <li>If request body size is not limited, an attacker can upload large size of input payload, causing server to run out of memory, or make processor and event loop busy.</li>\n                </ol>\n\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                Here are some node.js and express specific configuration measures:\n                <ul>\n                    <li>\n                        Use latest stable version of node.js and express (or other web framework you are using). Keep a watch on published vulnerabilities of these. The vulnerabilities for node.js and express.js can be found <a href=\"http://blog.nodejs.org/vulnerability/\">here</a> and\n                        <a href=\"http://expressjs.com/advanced/security-updates.html\">here</a>, respectively.\n                    </li>\n                    <li>\n                        Do not run application with root privileges. It may seem necessary to run as root user to access privileged ports such as 80. However, this can achieved either by starting server as root and then downgrading the non-privileged user after listening on port 80 is established, or using a separate proxy, or using port mapping.</li>\n                    <li>\n                        Review default in HTTP Response headers to prevent internal implementation disclosure.\n                    </li>\n                    <li>\n                        Use generic session cookie names\n                    </li>\n                    <li>\n                        Limit HTTP Request Body size by setting sensible size limits on each content type specific middleware (\n                        <code>urlencoded, json, multipart</code>) instead of using aggregate\n                        <code>limit</code>middleware. Include only required middleware. For example if application doesn't need to support file uploads, do not include multipart middleware.\n                        <li>\n                            If using multipart middleware, have a strategy to clean up temporary files generated by it. These files are not garbage collected by default, and an attacker can fill disk with such temporary files\n                        </li>\n                        <li>\n                            Vet npm packages used by the application\n                        </li>\n                        <li>\n                            Lock versions of all npm packages used, for example using <a href=\"https://www.npmjs.org/doc/cli/npm-shrinkwrap.html\"> shrinkwarp</a>, to have full control over when to install a new version of the package.\n                        </li>\n                        <li>\n                            Set security specific HTTP headers\n                        </li>\n                </ul>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Source Code Example</h3>\n            </div>\n            <div class=\"panel-body\">\n                <div>\n                    <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/lCpnVrD2Neg?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                </div>\n                <p>The default HTTP header x-powered-by can reveal implementation details to an attacker. It can be taken out by including this code in\n                    <code>server.js</code>\n                    <pre>   \n        app.disable(\"x-powered-by\"); \n    </pre>\n                </p>\n                <p>The default session cookie name for express sessions can be changed by setting key attribute while creating express session.\n                    <pre>\n        app.use(express.session({\n            secret: config.cookieSecret,\n            key: \"sessionId\",\n            cookie: {\n                httpOnly: true,\n                secure: true\n            }\n        }));\n    </pre>\n                </p>\n                <p>The security related HTTP Headers can be added using helmet middleware as below\n                    <pre>\n        // Prevent opening page in frame or iframe to protect from clickjacking\n        app.disable(\"x-powered-by\");\n\n        // Prevent opening page in frame or iframe to protect from clickjacking\n        app.use(helmet.xframe());\n\n        // Prevents browser from caching and storing page\n        app.use(helmet.noCache());\n\n        // Allow loading resources only from white-listed domains\n        app.use(helmet.csp());\n\n        // Allow communication only on HTTPS\n        app.use(helmet.hsts());\n\n        // Forces browser to only use the Content-Type set in the response header instead of sniffing or guessing it\n        app.use(nosniff());\n\n</pre>\n                </p>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "119",
							"uri": "http://dacn:4000/tutorial/a6",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A6-Sensitive Data Exposure\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-default\">Exploitability: DIFFICULT</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-danger\">Detectability: AVERAGE</span>\n            <span class=\"label label-danger\">Technical Impact: SEVERE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                This vulnerability allows an attacker to access sensitive data such as credit cards, tax IDs, authentication credentials, etc to conduct credit card fraud, identity theft, or other crimes. Losing such data can cause severe business impact and damage to the reputation. Sensitive data deserves extra protection such as encryption at rest or in transit, as well as special precautions when exchanged with the browser.\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>If a site doesn\u2019t use SSL/TLS for all authenticated pages, an attacker can monitor network traffic (such as on open wireless network), and steals user's session cookie. Attacker can then replay this cookie and hijacks the user's session, accessing the user's private data.</p>\n                <p>If an attacker gets access the application database, he or she can steal the sensitive information not encrypted, or encrypted with weak encryption algorithm</p>\n\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                <ul>\n                    <li>Use Secure HTTPS network protocol</li>\n                    <li>Encrypt all sensitive data at rest and in transit</li>\n                    <li>Don\u2019t store sensitive data unnecessarily. Discard it as soon as possible.</li>\n                    <li>Ensure strong standard algorithms and strong keys are used, and proper key management is in place.</li>\n                    <li>Disable autocomplete on forms collecting sensitive data and disable caching for pages that contain sensitive data.</li>\n                </ul>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Source Code Example</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>1.The insecure demo application uses HTTP connection to communicate with server. A secure HTTPS sever can be set using https module. This would need a private key and certificate. Here are source code examples from\n                    <code>/server.js</code>\n                    <pre>\n// Load keys for establishing secure HTTPS connection\nvar fs = require(\"fs\");\nvar https = require(\"https\");\nvar path = require(\"path\");\nvar httpsOptions = {\n    key: fs.readFileSync(path.resolve(__dirname, \"./app/cert/key.pem\")),\n    cert: fs.readFileSync(path.resolve(__dirname, \"./app/cert/cert.pem\"))\n};\n               </pre>\n                </p>\n                <p>2. Start secure HTTPS sever\n                    <pre>\n// Start secure HTTPS server\nhttps.createServer(httpsOptions, app).listen(config.port, function() {\n    console.log(\"Express https server listening on port \" + config.port);\n});\n                </pre>\n                </p>\n                <p>\n                    3. The insecure demo application stores users personal sensitive information in plain text. To fix it, The\n                    <code>data/profile-dao.js</code>can be modified to use crypto module to encrypt and decrypt sensitive information as below:\n                    <pre>\n// Include crypto module\nvar crypto = require(\"crypto\");\n\n//Set keys config object\nvar config = {\n    cryptoKey: \"a_secure_key_for_crypto_here\",\n    cryptoAlgo: \"aes256\", // or other secure encryption algo here\n    iv: \"\"\n};\n\n// Helper method create initialization vector\n// By default the initialization vector is not secure enough, so we create our own\nvar createIV = function() {\n    // create a random salt for the PBKDF2 function - 16 bytes is the minimum length according to NIST\n    var salt = crypto.randomBytes(16);\n    return crypto.pbkdf2Sync(config.cryptoKey, salt, 100000, 512, \"sha512\");\n};\n\n// Helper methods to encryt / decrypt\nvar encrypt = function(toEncrypt) {\n    config.iv = createIV();\n    var cipher = crypto.createCipheriv(config.cryptoAlgo, config.cryptoKey, config.iv);\n    return cipher.update(toEncrypt, \"utf8\", \"hex\") + cipher.final(\"hex\");\n};\n\nvar decrypt = function(toDecrypt) {\n    var decipher = crypto.createDecipheriv(config.cryptoAlgo, config.cryptoKey, config.iv);\n    return decipher.update(toDecrypt, \"hex\", \"utf8\") + decipher.final(\"utf8\");\n};\n\n// Encrypt values before saving in database\nuser.ssn = encrypt(ssn);\nuser.dob = encrypt(dob);\n\n// Decrypt values to show on view\nuser.ssn = decrypt(user.ssn);\nuser.dob = decrypt(user.dob);\n</pre>\n\n                </p>\n            </div>\n        </div>\n\n\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "117",
							"uri": "http://dacn:4000/tutorial/a8",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A8-Cross-Site Request Forgery (CSRF) \n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-warning\">Exploitability: AVERAGE</span>\n            <span class=\"label label-warning\">Prevalence: COMMON</span>\n            <span class=\"label label-danger\">Detectability: EASY</span>\n            <span class=\"label label-warning\">Technical Impact: MODERATE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                A CSRF attack forces a logged-on victim\u2019s browser to send a forged HTTP request, including the victim\u2019s session cookie and any other automatically included authentication information, to a vulnerable web application. This allows the attacker to force the victim\u2019s browser to generate requests that the vulnerable application processes as legitimate requests from the victim.\n            </div>\n        </div>\n        <!--\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Real World Attack Incident Examples</h3>\n            </div>\n            <div class=\"panel-body\">\n                Screencast here ...\n            </div>\n        </div>\n-->\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    As browsers automatically send credentials like session cookies with HTTP requests to the server where cookies were received from, attackers can create malicious web pages which generate forged requests that are indistinguishable from legitimate ones.</p>\n                <p>For example, CSRF vulnerability can be exploited on profile form on the insecure demo application.</p>\n                <iframe width=\"560\" height=\"315\" src=\"//www.youtube.com/embed/vRDykS_2y3I?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n                <p>To exploit it:\n                    <ol>\n                        <li>An attacker would need to host a forged form like below on a malicious sever.\n                            <pre>\n    &lt;html lang=\"en\"&gt;\n    &lt;head&gt;&lt;/head&gt;\n    \t&lt;body&gt;\n    \t\t&lt;form method=\"POST\" action=\"http://TARGET_APP_URL_HERE/profile\"&gt;\n    \t\t\t&lt;h1&gt; You are about to win a brand new iPhone!&lt;/h1&gt;\n    \t\t\t&lt;h2&gt; Click on the win button to claim it...&lt;/h2&gt;\n    \t\t\t&lt;input type=\"hidden\" name=\"bankAcc\" value=\"9999999\"/&gt;\n    \t\t\t&lt;input type=\"hidden\" name=\"bankRouting\" value=\"88888888\"/&gt;\n                                &lt;input type=\"submit\" value=\"Win !!!\"/&gt;\n    \t\t&lt;/form&gt;\n    \t&lt;/body&gt;\n    &lt;/html&gt;\n              </pre> Note: A sample app containing form for CSRF attack on NodeGoat app is available <a target=\"_blank\" href=\"https://github.com/ckarande/nodegoat-csrf-attack\">here</a>.\n                        </li>\n                        <li>Next, attacker would need to manage opening the form on logged in victim's browser and attract user to submit it. When user submits this form, it results in victim user's browser sending a malicious request to vulnerable server, causing CSRF attack.\n                        </li>\n                    </ol>\n                </p>\n\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>Express csrf middleware provides a very effective way to deal with csrf attack. By default this middleware generates a token named \"_csrf\" which should be added to requests which mutate state (PUT, POST, DELETE), within a hidden form field, or query-string, or header fields.</p>\n                <p>If using method-override middleware, it is very important that it is used before any middleware that needs to know the method of the request, including CSRF middleware. Otherwise an attacker can use non-state mutating methods (such as GET) to bypass the CSRF middleware checks, and use method override header to convert request to desired method.</p>\n                <p>When form is submitted, the middleware checks for existence of token and validates it by matching to the generated token for the response-request pair. If tokens do not match, it rejects the request. Thus making it really hard for an attacker to exploit CSRF.\n                </p>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Source Code Example</h3>\n            </div>\n            <div class=\"panel-body\">\n                The\n                <code>server.js</code>includes the express CSRF middleware after session is initialized. Then creates a custom middleware to generate new token using\n                <code>req.csrfToken();</code>and exposes it to view by setting it in\n                <code>res.locals</code>\n                <pre>\n        //Enable Express csrf protection\n        app.use(express.csrf());\n\n        app.use(function(req, res, next) { \n            res.locals.csrftoken = req.csrfToken(); \n            next(); \n        }); </pre> Next, this token can be included in a hidden form field in\n                <code>views/profile.html</code>as below.\n                <pre>\n    &lt;input type=\"hidden\" name=\"_csrf\" value=\"{{ csrftoken } }\"&gt;</pre>\n            </div>\n        </div>\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "106",
							"uri": "http://dacn:4000/tutorial/a9",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>A9-Using Components with Known Vulnerabilities\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"bs-example\" style=\"margin-bottom: 40px;\">\n            <span class=\"label label-warning\">Exploitability: AVERAGE</span>\n            <span class=\"label label-danger\">Prevalence: WIDESPREAD</span>\n            <span class=\"label label-default\">Detectability: DIFFICULT</span>\n            <span class=\"label label-warning\">Technical Impact: MODERATE</span>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>Components, such as libraries, frameworks, and other software modules, almost always run with full privileges. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications using components with known vulnerabilities may undermine application defenses and enable a range of possible attacks and impacts.\n                </p>\n                <p>Using insecure npm packages can lead to this vulnerability. Some projects today help test and alert on insecure dependencies:\n                    <ol>\n                        <li>\n                            <a href=\"https://docs.npmjs.com/cli/v6/commands/npm-audit\">npm audit</a> is a vulnerability scanner built into the npm CLI (version 6 or later)\n                        </li>\n                        <li>\n                            <a href=\"https://docs.github.com/en/github/managing-security-vulnerabilities/configuring-dependabot-security-updates\">Dependabot security updates</a> can automatically make GitHub pull requests to update vulnerable dependencies\n                        </li>\n                        <li>\n                            <a href=\"https://snyk.io/\">Snyk.io</a> is a Node.js CLI tool and Platform to scan and detect vulnerable packages\n                        </li>\n                    </ol>\n                </p>\n                <p>The tools above make use of vulnerability lists, which can also be viewed directly or searched here:\n                    <ol>\n                        <li>\n                            <a href=\"https://www.npmjs.com/advisories\">NPM Security Advisories</a>\n                        </li>\n                        <li>\n                            <a href=\"https://github.com/advisories\">GitHub Advisory Database</a>\n                        </li>\n                        <li>\n                            <a href=\"https://snyk.io/vuln\">Snyk Vulnerability DB</a>\n                        </li>\n                    </ol>\n                </p>\n                <p>There are some other tools that can detect and update outdated packages:\n                    <ol>\n                        <li>\n                            <a href=\"https://docs.npmjs.com/cli/v6/commands/npm-outdated\">npm outdated</a> and <a href=\"https://classic.yarnpkg.com/en/docs/cli/outdated\">yarn outdated</a> are both command line ways to show possibly out of date dependencies\n                        </li>\n                        <li>\n                            <a href=\"https://docs.github.com/en/code-security/supply-chain-security/about-dependabot-version-updates\">Dependabot version updates</a> can automatically make GitHub pull requests to update outdated dependencies\n                        </li>\n                        <li>\n                            <a href=\"https://david-dm.org/\">David DM</a> gets you an overview of your project dependencies, the version you use and the latest available, so you can quickly see what's drifting\n                        </li>\n                        <li>\n                            <a href=\"https://www.npmjs.com/package/npm-check\">npm-check</a> Check for outdated, incorrect, and unused dependencies\n                        </li>\n                    </ol>\n                </p>\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                The npm packages are essential part of our node application. These packages could either accidentally or maliciously contain insecure code. Through insecure packages an attacker can:\n                <ul>\n                    <li>Create and run scripts at different stages during installation or usage of the package.</li>\n                    <li>Read, write, update, delete files on system</li>\n                    <li>Write and execute binary files</li>\n                    <li>Collect sensitive data send it remotely</li>\n                </ul>\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                These are few measures we can take to protect against malicious npm packages\n                <ul>\n                    <li>Do not run application with root privileges</li>\n                    <li>Prefer packages that include static code analysis. Check JSHint/JSLint the configuration to know what rules code abide by</li>\n                    <li>Prefer packages that contain comprehensive unit tests and review tests for the functions our application uses</li>\n                    <li>Review code for any unexpected file or database access</li>\n                    <li>Research about how popular the package is, what other packages use it, if any other packages are written by the author, etc</li>\n                    <li>Lock version of packages used</li>\n                    <li>Watch Github repositories for notifications. This will inform us if any vulnerabilities are discovered in the package in future</li>\n                </ul>\n            </div>\n        </div>\n\n        <div id=\"source-code-example\" class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Insecure Dependencies Example</h3>\n            </div>\n            <div class=\"panel-body\">\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Description</h3>\n                    </div>\n                    <div class=\"panel-body\">\n\n                        <p>\n                            The demo web application is using a popular library called <a href=\"https://github.com/chjj/marked\"> Marked </a> which is a Markdown parser in JavaScript and provides an easy way to integrate markdown syntax for rich text to a website, replacing the need to build WYSIWYG editors.\n                        </p>\n\n                        <p>\n                            This library has reached almost millions of downloads a month, making it quite popular with also\n                            <strong> 11,000 </strong> stars on GitHub at one point.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"panel panel-default\">\n                    <div class=\"panel-heading\">\n                        <h3 class=\"panel-title\">Attack Mechanics</h3>\n                    </div>\n                    <div class=\"panel-body\">\n\n                        <p>\n                            In this demo project we are using an insecure version of the Marked library that is vulnerable to XSS exploits.\n                        </p>\n\n                        <p>\n                            <strong>Scenario: </strong> A form on a page allows free text user input which is later parsed using the Marked library to markdown format and compiled in a dedicated view to show the rich text version. An attacker can exploit this form to insert malicious XSS strings which the Markdown library isn't filtering very well, resulting in an XSS attack.\n\n                        </p>\n\n                        <p>\n                            Try sending one of the following markdown syntax strings in the Memos section to exploit it and see which one succeeds:\n\n\n\n\n                            <ol>\n\n                                <li>\n                                    <code>\n                                        <xmp>\n                                            [Nice try](javascript:alert(1))\n                                        </xmp>\n                                    </code>\n                                </li>\n                                <li>\n                                    <code>\n                                        <xmp>\n                                            [Hi there](javascript&#58;alert(1&#41;)\n                                        </xmp>\n                                    </code>\n                                </li>\n                                <li>\n                                    <code>\n                                        <xmp>\n                                            [I'm here!](javascript&#58this;alert(1&#41;)\n                                        </xmp>\n                                    </code>\n                                </li>\n                            </ol>\n                        </p>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n    </div>\n</div>\n\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						},
						{
							"id": "134",
							"uri": "http://dacn:4000/tutorial/redos",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "<script src=\"../vendor/html5shiv.js\"><![endif]-->\n</head>\n\n<body>\n\n    <div id=\"wrapper\">\n\n        <!-- Sidebar -->\n        <nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\">\n            <!-- Brand and toggle get grouped for better mobile display -->\n            <div class=\"navbar-header\">\n                <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-ex1-collapse\">\n                    <span class=\"sr-only\">Toggle navigation</span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                    <span class=\"icon-bar\"></span>\n                </button>\n                <a class=\"navbar-brand\" href=\"/tutorial\"><b>OWASP Node Goat Tutorial:</b> Fixing OWASP Top 10 </a>\n            </div>\n\n            <!-- Collect the nav links, forms, and other content for toggling -->\n            <div class=\"collapse navbar-collapse navbar-ex1-collapse\">\n                <ul class=\"nav navbar-nav side-nav\">\n                    <li><a href=\"/tutorial/a1\"><i class=\"fa fa-wrench\"></i> A1 Injection</a>\n                    </li>\n                    <li><a href=\"/tutorial/a2\"><i class=\"fa fa-wrench\"></i> A2 Broken Auth</a>\n                    </li>\n                    <li><a href=\"/tutorial/a3\"><i class=\"fa fa-wrench\"></i> A3 XSS</a>\n                    </li>\n                    <li><a href=\"/tutorial/a4\"><i class=\"fa fa-wrench\"></i> A4 Insecure DOR</a>\n                    </li>\n                    <li><a href=\"/tutorial/a5\"><i class=\"fa fa-wrench\"></i> A5 Misconfig</a>\n                    </li>\n                    <li><a href=\"/tutorial/a6\"><i class=\"fa fa-wrench\"></i> A6 Sensitive Data</a>\n                    </li>\n                    <li><a href=\"/tutorial/a7\"><i class=\"fa fa-wrench\"></i> A7 Access Controls</a>\n                    </li>\n                    <li><a href=\"/tutorial/a8\"><i class=\"fa fa-wrench\"></i> A8 CSRF</a>\n                    </li>\n                    <li><a href=\"/tutorial/a9\"><i class=\"fa fa-wrench\"></i> A9 Insecure Components</a>\n                    </li>\n                    <li><a href=\"/tutorial/a10\"><i class=\"fa fa-wrench\"></i> A10 Redirects</a>\n                    </li>\n                    <li><a href=\"/tutorial/redos\"><i class=\"fa\"></i> ReDoS Attacks</a>\n                    </li>\n                    <li><a href=\"/tutorial/ssrf\"><i class=\"fa\"></i> SSRF</a>\n                    </li>\n                </ul>\n\n                <ul class=\"nav navbar-nav navbar-right navbar-user\">\n                    <li><a href=\"/login\"><i class=\"fa fa-power-off\"></i> Exit</a>\n                    </li>\n                </ul>\n            </div>\n            <!-- /.navbar-collapse -->\n        </nav>\n\n        <div id=\"page-wrapper\">\n\n            <div class=\"row\">\n                <div class=\"col-lg-12\">\n                    <h1>ReDoS Regular Expressions DoS\n                        <small></small>\n                    </h1>\n                </div>\n            </div>\n            <!-- /.row -->\n            \n<div class=\"row\">\n    <div class=\"col-lg-12\">\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Description</h3>\n            </div>\n            <div class=\"panel-body\">\n                The Regular expression Denial of Service (<a href=\"https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\">ReDoS</a>) is a Denial of Service attack, that exploits the fact that most Regular Expression implementations may reach extreme situations that cause them to work very slowly (exponentially related to input size). An attacker can then cause a program using a Regular Expression to enter these extreme situations and then hang for a very long time.\n            </div>\n        </div>\n\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">Attack Mechanics</h3>\n            </div>\n            <div class=\"panel-body\">\n                <p>\n                    When untrusted data input is executed on a regex pattern, it may exploit vulnerable patterns into running long calculations to match for a given string. For Node.js this is extremely important due to the single-threaded event-loop architecture which means that the main Node.js process is blocked from serving any other requests.\n                </p>\n            </div>\n        </div>\n        <div class=\"panel panel-info\">\n            <div class=\"panel-heading\">\n                <h3 class=\"panel-title\">How Do I Prevent It?</h3>\n            </div>\n            <div class=\"panel-body\">\n                <ol>\n                    <li>\n                        Avoid writing your own regular expressions\n                    </li>\n                    <li>\n                        Use Node.js's <a href=\"https://github.com/chriso/validator.js/\">validator.js</a> package to validate expected data format instead of writing your own regular expressions\n                    </li>\n                    <li>\n                        As a last resort of writing your own regex patterns you can utilize Node.js's\n                        <a href=\"https://github.com/substack/safe-regex\">safe-regex</a> package which allows detecting if a regex is prone to catastrophic backtracking, and also allows to configure threshold for maximum repetitions.\n                    </li>\n                </ol>\n            </div>\n        </div>\n    </div>\n    <div class=\"panel panel-info\">\n        <div class=\"panel-heading\">\n            <h3 class=\"panel-title\">Source Code Example</h3>\n        </div>\n        <div class=\"panel-body\">\n            <p>\n                Even simple regex patterns are vulnerable to ReDoS. The NodeGoat project uses the following source code to validate text format from the user based on a regex pattern:\n\n                <pre>\n// Allow only numbers with a suffix of #, for example: 'XXXXXX#'\nvar regexPattern = /([0-9]+)+\\#/;\nvar testComplyWithRequirements = regexPattern.test(bankRouting)\n                </pre> If a long enough input is provided it will stall the Node.js process and render it useless (in the background the Node.js process will take 100% cpu until stopped or the regex yields a result (true or false)). Try to input the following string in the Bank Routing number in the Profile form:\n                <pre>\n91762612117612121123123123123121\n                </pre>\n\n            </p>\n        </div>\n    </div>\n</div>\n</div>\n        </div>\n        <!-- /#page-wrapper -->\n\n    </div>\n    <!-- /#wrapper -->\n\n    <script src=\"../vendor/jquery.min.js\"></script>",
							"otherinfo": "No links have been found while there are scripts, which is an indication that this is a modern web application."
						}
					],
					"count": "11",
					"solution": "<p>This is an informational alert and so no changes are required.</p>",
					"otherinfo": "<p>Links have been found that do not have traditional href attributes, which is an indication that this is a modern web application.</p>",
					"reference": "",
					"cweid": "-1",
					"wascid": "-1",
					"sourceid": "3"
				},
				{
					"pluginid": "10049",
					"alertRef": "10049-1",
					"alert": "Non-Storable Content",
					"name": "Non-Storable Content",
					"riskcode": "0",
					"confidence": "2",
					"riskdesc": "Informational (Medium)",
					"desc": "<p>The response contents are not storable by caching components such as proxy servers. If the response does not contain sensitive, personal or user-specific information, it may benefit from being stored and cached, to improve performance.</p>",
					"instances":[ 
						{
							"id": "25",
							"uri": "http://dacn:4000",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "302",
							"otherinfo": ""
						},
						{
							"id": "9",
							"uri": "http://dacn:4000/",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "302",
							"otherinfo": ""
						}
					],
					"count": "2",
					"solution": "<p>The content may be marked as storable by ensuring that the following conditions are satisfied:</p><p>The request method must be understood by the cache and defined as being cacheable (\"GET\", \"HEAD\", and \"POST\" are currently defined as cacheable)</p><p>The response status code must be understood by the cache (one of the 1XX, 2XX, 3XX, 4XX, or 5XX response classes are generally understood)</p><p>The \"no-store\" cache directive must not appear in the request or response header fields</p><p>For caching by \"shared\" caches such as \"proxy\" caches, the \"private\" response directive must not appear in the response</p><p>For caching by \"shared\" caches such as \"proxy\" caches, the \"Authorization\" header field must not appear in the request, unless the response explicitly allows it (using one of the \"must-revalidate\", \"public\", or \"s-maxage\" Cache-Control response directives)</p><p>In addition to the conditions above, at least one of the following conditions must also be satisfied by the response:</p><p>It must contain an \"Expires\" header field</p><p>It must contain a \"max-age\" response directive</p><p>For \"shared\" caches such as \"proxy\" caches, it must contain a \"s-maxage\" response directive</p><p>It must contain a \"Cache Control Extension\" that allows it to be cached</p><p>It must have a status code that is defined as cacheable by default (200, 203, 204, 206, 300, 301, 404, 405, 410, 414, 501).</p>",
					"otherinfo": "",
					"reference": "<p>https://datatracker.ietf.org/doc/html/rfc7234</p><p>https://datatracker.ietf.org/doc/html/rfc7231</p><p>https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html</p>",
					"cweid": "524",
					"wascid": "13",
					"sourceid": "10"
				},
				{
					"pluginid": "10112",
					"alertRef": "10112",
					"alert": "Session Management Response Identified",
					"name": "Session Management Response Identified",
					"riskcode": "0",
					"confidence": "2",
					"riskdesc": "Informational (Medium)",
					"desc": "<p>The given response has been identified as containing a session management token. The 'Other Info' field contains a set of header tokens that can be used in the Header Based Session Management Method. If the request is in a context which has a Session Management Method set to \"Auto-Detect\" then this rule will change the session management to use the tokens identified.</p>",
					"instances":[ 
						{
							"id": "16",
							"uri": "http://dacn:4000",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "17",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "15",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "21",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "1",
							"uri": "http://dacn:4000/",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "45",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						},
						{
							"id": "148",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap-tour.css",
							"method": "GET",
							"param": "connect.sid",
							"attack": "",
							"evidence": "connect.sid",
							"otherinfo": "cookie:connect.sid"
						}
					],
					"count": "7",
					"solution": "<p>This is an informational alert rather than a vulnerability and so there is nothing to fix.</p>",
					"otherinfo": "<p>cookie:connect.sid</p>",
					"reference": "<p>https://www.zaproxy.org/docs/desktop/addons/authentication-helper/session-mgmt-id/</p>",
					"cweid": "-1",
					"wascid": "-1",
					"sourceid": "10"
				},
				{
					"pluginid": "10049",
					"alertRef": "10049-3",
					"alert": "Storable and Cacheable Content",
					"name": "Storable and Cacheable Content",
					"riskcode": "0",
					"confidence": "2",
					"riskdesc": "Informational (Medium)",
					"desc": "<p>The response contents are storable by caching components such as proxy servers, and may be retrieved directly from the cache, rather than from the origin server by the caching servers, in response to similar requests from other users. If the response data is sensitive, personal or user-specific, this may result in sensitive information being leaked. In some cases, this may even result in a user gaining complete control of the session of another user, depending on the configuration of the caching components in use in their environment. This is primarily an issue where \"shared\" caching servers such as \"proxy\" caches are configured on the local network. This configuration is typically found in corporate or educational environments, for instance.</p>",
					"instances":[ 
						{
							"id": "10",
							"uri": "http://dacn:4000/login",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": "In the absence of an explicitly specified caching lifetime directive in the response, a liberal lifetime heuristic of 1 year was assumed. This is permitted by rfc7234."
						},
						{
							"id": "33",
							"uri": "http://dacn:4000/robots.txt",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": "In the absence of an explicitly specified caching lifetime directive in the response, a liberal lifetime heuristic of 1 year was assumed. This is permitted by rfc7234."
						},
						{
							"id": "50",
							"uri": "http://dacn:4000/signup",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": "In the absence of an explicitly specified caching lifetime directive in the response, a liberal lifetime heuristic of 1 year was assumed. This is permitted by rfc7234."
						},
						{
							"id": "39",
							"uri": "http://dacn:4000/sitemap.xml",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "",
							"otherinfo": "In the absence of an explicitly specified caching lifetime directive in the response, a liberal lifetime heuristic of 1 year was assumed. This is permitted by rfc7234."
						}
					],
					"count": "4",
					"solution": "<p>Validate that the response does not contain sensitive, personal or user-specific information. If it does, consider the use of the following HTTP response headers, to limit, or prevent the content being stored and retrieved from the cache by another user:</p><p>Cache-Control: no-cache, no-store, must-revalidate, private</p><p>Pragma: no-cache</p><p>Expires: 0</p><p>This configuration directs both HTTP 1.0 and HTTP 1.1 compliant caching servers to not store the response, and to not retrieve the response (without validation) from the cache, in response to a similar request.</p>",
					"otherinfo": "<p>In the absence of an explicitly specified caching lifetime directive in the response, a liberal lifetime heuristic of 1 year was assumed. This is permitted by rfc7234.</p>",
					"reference": "<p>https://datatracker.ietf.org/doc/html/rfc7234</p><p>https://datatracker.ietf.org/doc/html/rfc7231</p><p>https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html</p>",
					"cweid": "524",
					"wascid": "13",
					"sourceid": "3"
				},
				{
					"pluginid": "10049",
					"alertRef": "10049-2",
					"alert": "Storable but Non-Cacheable Content",
					"name": "Storable but Non-Cacheable Content",
					"riskcode": "0",
					"confidence": "2",
					"riskdesc": "Informational (Medium)",
					"desc": "<p>The response contents are storable by caching components such as proxy servers, but will not be retrieved directly from the cache, without validating the request upstream, in response to similar requests from other users.</p>",
					"instances":[ 
						{
							"id": "85",
							"uri": "http://dacn:4000/images/owasplogo.png",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "max-age=0",
							"otherinfo": ""
						},
						{
							"id": "75",
							"uri": "http://dacn:4000/vendor/bootstrap/bootstrap.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "max-age=0",
							"otherinfo": ""
						},
						{
							"id": "70",
							"uri": "http://dacn:4000/vendor/jquery.min.js",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "max-age=0",
							"otherinfo": ""
						},
						{
							"id": "60",
							"uri": "http://dacn:4000/vendor/theme/font-awesome/css/font-awesome.min.css",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "max-age=0",
							"otherinfo": ""
						},
						{
							"id": "34",
							"uri": "http://dacn:4000/vendor/theme/sb-admin.css",
							"method": "GET",
							"param": "",
							"attack": "",
							"evidence": "max-age=0",
							"otherinfo": ""
						}
					],
					"count": "5",
					"solution": "",
					"otherinfo": "",
					"reference": "<p>https://datatracker.ietf.org/doc/html/rfc7234</p><p>https://datatracker.ietf.org/doc/html/rfc7231</p><p>https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html</p>",
					"cweid": "524",
					"wascid": "13",
					"sourceid": "47"
				},
				{
					"pluginid": "10031",
					"alertRef": "10031",
					"alert": "User Controllable HTML Element Attribute (Potential XSS)",
					"name": "User Controllable HTML Element Attribute (Potential XSS)",
					"riskcode": "0",
					"confidence": "1",
					"riskdesc": "Informational (Low)",
					"desc": "<p>This check looks at user-supplied input in query string parameters and POST data to identify where certain HTML attribute values might be controlled. This provides hot-spot detection for XSS (cross-site scripting) that will require further review by a security analyst to determine exploitability.</p>",
					"instances":[ 
						{
							"id": "125",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "email",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nemail=zaproxy@example.com\n\nThe user-controlled value was:\nzaproxy@example.com"
						},
						{
							"id": "120",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "firstName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nfirstName=ZAP\n\nThe user-controlled value was:\nzap"
						},
						{
							"id": "126",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "firstName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nfirstName=ZAP\n\nThe user-controlled value was:\nzaproxy@example.com"
						},
						{
							"id": "121",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "lastName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nlastName=ZAP\n\nThe user-controlled value was:\nzap"
						},
						{
							"id": "127",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "lastName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nlastName=ZAP\n\nThe user-controlled value was:\nzaproxy@example.com"
						},
						{
							"id": "122",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "password",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\npassword=ZAP\n\nThe user-controlled value was:\nzap"
						},
						{
							"id": "128",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "password",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\npassword=ZAP\n\nThe user-controlled value was:\nzaproxy@example.com"
						},
						{
							"id": "123",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "userName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nuserName=ZAP\n\nThe user-controlled value was:\nzap"
						},
						{
							"id": "129",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "userName",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nuserName=ZAP\n\nThe user-controlled value was:\nzaproxy@example.com"
						},
						{
							"id": "124",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "verify",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nverify=ZAP\n\nThe user-controlled value was:\nzap"
						},
						{
							"id": "130",
							"uri": "http://dacn:4000/signup",
							"method": "POST",
							"param": "verify",
							"attack": "",
							"evidence": "",
							"otherinfo": "User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:\n\nhttp://dacn:4000/signup\n\nappears to include user input in:\na(n) [input] tag [value] attribute\n\nThe user input found was:\nverify=ZAP\n\nThe user-controlled value was:\nzaproxy@example.com"
						}
					],
					"count": "11",
					"solution": "<p>Validate all input and sanitize output it before writing to any HTML attributes.</p>",
					"otherinfo": "<p>User-controlled HTML attribute values were found. Try injecting special characters to see if XSS might be possible. The page at the following URL:</p><p></p><p>http://dacn:4000/signup</p><p></p><p>appears to include user input in:</p><p>a(n) [input] tag [value] attribute</p><p></p><p>The user input found was:</p><p>email=zaproxy@example.com</p><p></p><p>The user-controlled value was:</p><p>zaproxy@example.com</p>",
					"reference": "<p>https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html</p>",
					"cweid": "20",
					"wascid": "20",
					"sourceid": "57"
				}
			]
		}
	],
	"sequences":[
	]

}
